(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[4735],{3075:e=>{e.exports=function(){return this.wp.i18n}()},8601:e=>{e.exports=function(){return this.wp.element}()},29672:e=>{e.exports=function(){return this.wp.notices}()},31987:e=>{e.exports=function(){return this.wp.data}()},51609:e=>{"use strict";e.exports=window.React},66087:e=>{"use strict";e.exports=window.lodash},77172:e=>{e.exports=function(){return this.wp.url}()},85631:e=>{e.exports=function(){return this.wp.apiFetch}()},96691:(e,t,r)=>{"use strict";r.r(t),r.d(t,{BANS_STORE_NAME:()=>Ke,CORE_STORE_NAME:()=>Gt,HELP_STORE_NAME:()=>st,MODULES_STORE_NAME:()=>lt,apiFetch:()=>M,apiFetchBatch:()=>J,apiFetchResult:()=>G,awaitPromise:()=>W,controls:()=>ee,coreStore:()=>fc,createNotice:()=>z,dispatch:()=>$,fetch:()=>j,firewallStore:()=>ju,logsStore:()=>vo,modulesStore:()=>Pr,parseFetchResponse:()=>K,patchstackStore:()=>Xn,select:()=>Y,siteScannerStore:()=>Tn,toolsStore:()=>rs,trustedDevicesStore:()=>yl,updateSettings:()=>X,userSecurityStore:()=>ru,vulnerabilitiesStore:()=>Ys});var s={};r.r(s),r.d(s,{FAILED_CREATE_BAN:()=>Re,FAILED_DELETE_BAN:()=>Le,FAILED_QUERY:()=>Te,FAILED_UPDATE_BAN:()=>Qe,FINISH_CREATE_BAN:()=>Ae,FINISH_DELETE_BAN:()=>xe,FINISH_QUERY:()=>qe,FINISH_UPDATE_BAN:()=>Pe,RECEIVE_BAN:()=>be,RECEIVE_QUERY:()=>_e,START_CREATE_BAN:()=>ve,START_DELETE_BAN:()=>Ue,START_QUERY:()=>he,START_UPDATE_BAN:()=>Ne,createBan:()=>me,deleteBan:()=>Se,failedCreateBan:()=>ce,failedDeleteBan:()=>Ee,failedUpdateBan:()=>de,fetchQueryNextPage:()=>ie,finishCreateBan:()=>ae,finishDeleteBan:()=>pe,finishUpdateBan:()=>ge,path:()=>re,query:()=>se,receiveBan:()=>oe,receiveQuery:()=>ue,refreshQuery:()=>ne,startCreateBan:()=>le,startDeleteBan:()=>fe,startUpdateBan:()=>ye,updateBan:()=>Ie});var n={};r.r(n),r.d(n,{getBan:()=>Ve,getBans:()=>Ce,getQueryHeader:()=>ke,getQueryHeaderLink:()=>Oe,getQueryHeaderLinks:()=>we,getQueryParams:()=>He,getQueryResults:()=>Fe,isDeleting:()=>Me,isQuerying:()=>Ge,isUpdating:()=>Be});var i={};r.r(i),r.d(i,{getBans:()=>Ye});var u={};r.r(u),r.d(u,{RECEIVE_HELP:()=>ze,enableHelp:()=>Xe,fetchHelp:()=>We});var o={};r.r(o),r.d(o,{getHelp:()=>Ze,isEnabled:()=>et});var l={};r.r(l),r.d(l,{getHelp:()=>tt});var c={};r.r(c),r.d(c,{EDIT_MODULE:()=>Pt,EDIT_SETTING:()=>Ft,EDIT_SETTINGS:()=>Ct,FAILED_SAVING_MODULES:()=>xt,FAILED_SAVING_SETTINGS:()=>Ht,FINISH_SAVING_MODULES:()=>Lt,FINISH_SAVING_SETTINGS:()=>Vt,RECEIVE_MODULE:()=>Nt,RECEIVE_MODULES:()=>bt,RECEIVE_SETTINGS:()=>Dt,RESET_MODULE_EDITS:()=>Qt,RESET_SETTING_EDIT:()=>Ot,RESET_SETTING_EDITS:()=>wt,START_SAVING_MODULES:()=>Ut,START_SAVING_SETTINGS:()=>kt,activateModule:()=>dt,deactivateModule:()=>gt,editModule:()=>ct,editSetting:()=>pt,editSettings:()=>Et,fetchModules:()=>Tt,receiveModule:()=>At,receiveModules:()=>vt,receiveSettings:()=>Rt,resetModuleEdits:()=>yt,resetSettingEdits:()=>mt,saveModules:()=>at,saveSettings:()=>It,setModulesStatus:()=>ft,updateSettings:()=>St,validateSettings:()=>_t});var a={};r.r(a),r.d(a,{__unstableGetAllEditedSettings:()=>dr,__unstableGetAllSettings:()=>yr,areSettingsDirty:()=>lr,getActiveModules:()=>Kt,getDirtyModules:()=>Zt,getDirtySettings:()=>or,getEditedModule:()=>jt,getEditedModules:()=>$t,getEditedSetting:()=>ir,getEditedSettings:()=>nr,getError:()=>cr,getModule:()=>Wt,getModuleEdits:()=>zt,getModules:()=>Yt,getResult:()=>ar,getSetting:()=>rr,getSettingEdits:()=>sr,getSettingSchema:()=>gr,getSettings:()=>tr,getSettingsConditionalSchema:()=>Er,isActive:()=>Xt,isModuleDirty:()=>er,isSavingModule:()=>Jt,isSavingSettings:()=>ur});var y={};r.r(y),r.d(y,{__unstableGetAllEditedSettings:()=>_r,__unstableGetAllSettings:()=>Sr,getActiveModules:()=>vr,getEditedModule:()=>Tr,getEditedModules:()=>hr,getEditedSetting:()=>br,getEditedSettings:()=>Rr,getModule:()=>qr,getModules:()=>mr,getSetting:()=>Ar,getSettings:()=>Ir});var d={};r.r(d),r.d(d,{FAILED_TOGGLE_TOOL:()=>Or,FINISH_TOGGLE_TOOL:()=>wr,FINISH_TOOL:()=>Cr,RECEIVE_TOOLS:()=>Lr,START_TOGGLE_TOOL:()=>Fr,START_TOOL:()=>Dr,fetchTools:()=>Qr,runTool:()=>Ur,toggleTool:()=>xr});var g={};r.r(g),r.d(g,{getLastError:()=>Xr,getLastResult:()=>Kr,getResolvedTools:()=>Vr,getRunning:()=>$r,getTool:()=>Yr,getTools:()=>Br,getToolsConfig:()=>Gr,isRunning:()=>jr,isUpdating:()=>Wr});var f={};r.r(f),r.d(f,{getResolvedTools:()=>Zr,getTool:()=>es,getTools:()=>Jr});var E={};r.r(E),r.d(E,{FAILED_ACTION:()=>qs,FAILED_QUERY:()=>Ss,FINISH_ACTION:()=>hs,FINISH_QUERY:()=>Is,RECEIVE_QUERY:()=>ps,RECEIVE_VULNERABILITY:()=>Ts,START_ACTION:()=>_s,START_QUERY:()=>ms,applyVulnerabilityAction:()=>gs,deactivateSoftware:()=>ds,fetchQueryNextPage:()=>ls,fetchQueryPrevPage:()=>os,fixVulnerability:()=>ys,muteVulnerability:()=>as,query:()=>is,receiveQuery:()=>fs,receiveVulnerability:()=>Es,refreshQuery:()=>us});var p={};r.r(p),r.d(p,{getQueryHeader:()=>Us,getQueryHeaderLink:()=>bs,getQueryHeaderLinks:()=>Ns,getQueryParams:()=>xs,getQueryResults:()=>As,getVulnerabilities:()=>vs,getVulnerability:()=>Ls,getVulnerabilityActions:()=>Cs,getVulnerabilityById:()=>Ds,hasQueried:()=>Rs,isApplyingAction:()=>Hs,isDeactivatingSoftware:()=>ks,isFixing:()=>ws,isMuting:()=>Os,isQuerying:()=>Fs,queryHasNextPage:()=>Qs,queryHasPrevPage:()=>Ps});var m={};r.r(m),r.d(m,{getVulnerabilities:()=>Vs,getVulnerabilityById:()=>Bs});var I={};r.r(I),r.d(I,{FAILED_QUERY:()=>un,FAILED_SCAN:()=>an,FINISH_QUERY:()=>nn,FINISH_SCAN:()=>cn,RECEIVE_QUERY:()=>rn,RECEIVE_SCAN:()=>on,START_QUERY:()=>sn,START_SCAN:()=>ln,fetchQueryNextPage:()=>zs,fetchQueryPrevPage:()=>Xs,query:()=>Ks,receiveQuery:()=>tn,receiveScan:()=>en,refreshQuery:()=>Ws,runScan:()=>Zs});var S={};r.r(S),r.d(S,{getQueryHeader:()=>En,getQueryHeaderLink:()=>gn,getQueryHeaderLinks:()=>fn,getQueryParams:()=>pn,getQueryResults:()=>dn,getScan:()=>mn,getScans:()=>yn,isQuerying:()=>In,isScanning:()=>Sn});var _={};r.r(_),r.d(_,{getScans:()=>_n});var h={};r.r(h),r.d(h,{FAILED_QUERY:()=>Dn,FINISH_QUERY:()=>Ln,RECEIVE_QUERY:()=>Cn,START_QUERY:()=>xn,fetchQueryNextPage:()=>Pn,fetchQueryPrevPage:()=>Nn,query:()=>Rn,receiveQuery:()=>Un,refreshQuery:()=>bn});var q={};r.r(q),r.d(q,{getLastFetchError:()=>Yn,getPatchstackVulnerabilities:()=>Fn,getPatchstackVulnerability:()=>On,getQueryHeader:()=>Vn,getQueryHeaderLink:()=>kn,getQueryHeaderLinks:()=>Hn,getQueryParams:()=>Bn,getQueryResults:()=>wn,isQuerying:()=>$n,queryHasNextPage:()=>Mn,queryHasPrevPage:()=>Gn});var T={};r.r(T),r.d(T,{getPatchstackVulnerabilities:()=>jn});var v={};r.r(v),r.d(v,{CLOSE_QUICK_EDIT:()=>Qi,CONFIRM_QUICK_EDIT:()=>Ui,FAILED_ACTION:()=>vi,FAILED_QUERY:()=>hi,FINISH_ACTION:()=>Ti,FINISH_QUERY:()=>_i,OPEN_QUICK_EDIT:()=>Pi,RECEIVE_QUERY:()=>Ii,RECEIVE_USER:()=>Ai,REMOVE_SELECTED_USERS:()=>xi,START_ACTION:()=>qi,START_QUERY:()=>Si,TOGGLE_SELECTED_USER:()=>bi,TOGGLE_SELECT_ALL:()=>Ni,UPDATE_SELECTION_TYPE:()=>Ri,applyQueryActionsToUsers:()=>ci,applyQuickActionsToQuery:()=>li,closeQuickEdit:()=>pi,confirmQuickEdit:()=>mi,fetchQueryNextPage:()=>ni,fetchQueryPrevPage:()=>si,openQuickEdit:()=>Ei,query:()=>ti,quickEditsSuccessSnackbar:()=>ai,receiveQuery:()=>ui,receiveUser:()=>oi,refreshQuery:()=>ri,removeSelectedUsers:()=>fi,toggleSelectAll:()=>di,toggleSelectedUser:()=>gi,updateUserSelectionType:()=>yi});var A={};r.r(A),r.d(A,{getCurrentlySelectedUsers:()=>$i,getQueryHeader:()=>ki,getQueryHeaderLink:()=>Ci,getQueryHeaderLinks:()=>Fi,getQueryParams:()=>Hi,getQueryResults:()=>Di,getQuickActionsError:()=>Yi,getQuickEditActions:()=>zi,getQuickEditState:()=>Xi,getSelectAllState:()=>ji,getUser:()=>Vi,getUserById:()=>Bi,getUserSelectionType:()=>Mi,getUsers:()=>Li,isApplyingQuickActions:()=>Gi,isQuerying:()=>Ki,isUserSelected:()=>Wi,queryHasNextPage:()=>wi,queryHasPrevPage:()=>Oi});var R={};r.r(R),r.d(R,{getUserById:()=>Zi,getUsers:()=>Ji});var b={};r.r(b),r.d(b,{FAILED_QUERY:()=>hu,FINISH_QUERY:()=>_u,RECEIVE_ITEM:()=>Iu,RECEIVE_QUERY:()=>mu,START_QUERY:()=>Su,deleteItem:()=>Eu,editItem:()=>au,fetchQueryNextPage:()=>lu,fetchQueryPrevPage:()=>ou,query:()=>iu,refreshQuery:()=>uu,resetAllEdits:()=>du,resetEdits:()=>yu,saveEditedItem:()=>gu,saveItem:()=>fu});var N={};r.r(N),r.d(N,{getEditedItem:()=>Lu,getFirewallRules:()=>qu,getItem:()=>Qu,getItemById:()=>Uu,getLastDeleteError:()=>wu,getLastSaveError:()=>Ou,getQueryHeader:()=>Nu,getQueryHeaderLink:()=>vu,getQueryHeaderLinks:()=>Au,getQueryParams:()=>Pu,getQueryResults:()=>Tu,isDeleting:()=>Fu,isDirty:()=>Du,isQuerying:()=>xu,isSaving:()=>Cu,queryHasNextPage:()=>bu,queryHasPrevPage:()=>Ru});var P={};r.r(P),r.d(P,{getEditedItem:()=>Hu,getFirewallRules:()=>ku,getItemById:()=>Vu});var Q={};r.r(Q),r.d(Q,{FAILED_QUERY:()=>uo,FINISH_QUERY:()=>io,RECEIVE_LOG:()=>oo,RECEIVE_QUERY:()=>so,START_QUERY:()=>no,fetchQueryNextPage:()=>Zu,fetchQueryPrevPage:()=>Ju,query:()=>Xu,receiveLog:()=>ro,receiveQuery:()=>to,refreshQuery:()=>zu});var U={};r.r(U),r.d(U,{getLog:()=>Io,getLogById:()=>So,getLogs:()=>lo,getQueryHeader:()=>Eo,getQueryHeaderLink:()=>ao,getQueryHeaderLinks:()=>yo,getQueryParams:()=>po,getQueryResults:()=>co,isQuerying:()=>mo,queryHasNextPage:()=>fo,queryHasPrevPage:()=>go});var x={};r.r(x),r.d(x,{getLogById:()=>ho,getLogs:()=>_o});var L={};r.r(L),r.d(L,{FAILED_QUERY:()=>Bo,FINISH_QUERY:()=>Vo,RECEIVE_ITEM:()=>ko,RECEIVE_QUERY:()=>wo,START_QUERY:()=>Ho,editItem:()=>Uo,fetchQueryNextPage:()=>Po,fetchQueryPrevPage:()=>No,query:()=>Ro,refreshQuery:()=>bo,resetAllEdits:()=>Lo,resetEdits:()=>xo,saveEditedItem:()=>Do,saveEditedItems:()=>Co,saveItem:()=>Fo});var D={};r.r(D),r.d(D,{getDirtyItems:()=>tl,getEditedItem:()=>el,getItem:()=>zo,getItemById:()=>Jo,getLastSaveError:()=>il,getQueryHeader:()=>Ko,getQueryHeaderLink:()=>Go,getQueryHeaderLinks:()=>Yo,getQueryParams:()=>Wo,getQueryResults:()=>Mo,getQueryUser:()=>Xo,isDirty:()=>rl,isQuerying:()=>Zo,isSaving:()=>sl,isSavingAnyItems:()=>nl,queryHasNextPage:()=>jo,queryHasPrevPage:()=>$o});var C={};r.r(C),r.d(C,{getActorTypes:()=>hl,getActors:()=>ql,getAdminUrl:()=>Ql,getBatchMaxItems:()=>Al,getCurrentUser:()=>gl,getCurrentUserId:()=>fl,getFeatureFlags:()=>vl,getIndex:()=>ml,getInstallType:()=>bl,getRequirementsInfo:()=>_l,getRoles:()=>Sl,getSchema:()=>Il,getServerType:()=>Rl,getSiteInfo:()=>Tl,getUser:()=>dl,hasPatchstack:()=>Nl,isLiquidWebCustomer:()=>Pl,isSavingCurrentUser:()=>pl,isSavingUser:()=>El});var F={};r.r(F),r.d(F,{LOAD_INITIAL_FEATURE_FLAGS:()=>Xl,RECEIVE_ACTORS:()=>Kl,RECEIVE_ACTOR_TYPES:()=>jl,RECEIVE_ADMIN_URL:()=>Jl,RECEIVE_BATCH_MAX_ITEMS:()=>zl,RECEIVE_CURRENT_USER_ID:()=>$l,RECEIVE_INDEX:()=>Gl,RECEIVE_SITE_INFO:()=>Wl,RECEIVE_USER:()=>Yl,__unstableLoadInitialFeatureFlags:()=>Vl,fetchIndex:()=>Ul,fetchUser:()=>Cl,receiveActorTypes:()=>wl,receiveActors:()=>kl,receiveAdminUrl:()=>Ml,receiveBatchMaxItems:()=>Bl,receiveCurrentUserId:()=>Ol,receiveIndex:()=>xl,receiveSiteInfo:()=>Hl,receiveUser:()=>Fl,saveCurrentUser:()=>Ll,saveUser:()=>Dl});var O={};r.r(O),r.d(O,{getActorTypes:()=>cc,getActors:()=>ac,getBatchMaxItems:()=>dc,getCurrentUser:()=>lc,getIndex:()=>Zl,getInstallType:()=>nc,getRequirementsInfo:()=>rc,getRoles:()=>tc,getSchema:()=>ec,getServerType:()=>sc,getSiteInfo:()=>yc,getUser:()=>oc,hasPatchstack:()=>ic,isLiquidWebCustomer:()=>uc});var w=r(31987),k=r(66087),H=r(85631),V=r.n(H),B=r(62932);function M(e){return{type:"API_FETCH",request:e}}function G(e){return{type:"API_FETCH_RESULT",request:e}}function Y(e,t,...r){return{type:"SELECT",storeKey:e,selectorName:t,args:r}}function $(e,t,...r){return{type:"DISPATCH",storeKey:e,actionName:t,args:r}}function j(e,t){return{type:"FETCH",request:e,init:t}}function K(e){return{type:"PARSE_FETCH_RESPONSE",response:e}}function W(e,t){return{type:"AWAIT_PROMISE",promise:e,delay:t}}function X(e,t){return{type:"UPDATE_SETTINGS",module:e,settings:t}}function z(e="info",t,r={}){return{type:"CREATE_NOTICE",status:e,content:t,options:{context:"ithemes-security",...r}}}function J(e){return{type:"API_FETCH_BATCH",batch:e}}const Z={AWAIT_PROMISE:({promise:e,delay:t})=>{return t?Promise.all([e,(r=t,new Promise((e=>setTimeout(e,r))))]):e;var r},API_FETCH:({request:e})=>V()(e).catch(B.dD),API_FETCH_RESULT:({request:e})=>V()({...e,parse:!1}).then(B.Q7.fromResponse).catch(B.dD).catch((e=>e.getResponse?B.Q7.fromResponse(e.getResponse()):new B.Q7(B.Q7.ERROR,new B.AR("unknown_error","Unknown error")))),SELECT({storeKey:e,selectorName:t,args:r}){const s=(0,w.select)(e)[t];return s.hasResolver?(({storeKey:e,selectorName:t,args:r})=>new Promise((s=>{const n=()=>(0,w.select)("core/data").hasFinishedResolution(e,t,r),i=()=>(0,w.select)(e)[t].apply(null,r),u=i();if(n())return s(u);const o=(0,w.subscribe)((()=>{n()&&(o(),s(i()))}))})))({storeKey:e,selectorName:t,args:r}):s(...r)},DISPATCH:({storeKey:e,actionName:t,args:r})=>(0,w.dispatch)(e)[t](...r),PARSE_FETCH_RESPONSE:async function({response:e}){return await e.json()},FETCH:({request:e,init:t})=>window.fetch(e,t),UPDATE_SETTINGS:(0,w.createRegistryControl)((e=>({module:t,settings:r})=>e.dispatch("ithemes-security/modules").updateSettings(t,r))),CREATE_NOTICE({status:e,content:t,options:r}){r.autoDismiss&&(r.id=r.id||(0,k.uniqueId)("itsec-auto-dismiss-"),setTimeout((()=>(0,w.dispatch)("core/notices").removeNotice(r.id,r.context)),r.autoDismiss)),(0,w.dispatch)("core/notices").createNotice(e,t,r)},API_FETCH_BATCH:(0,w.createRegistryControl)((e=>async({batch:t})=>{const r=await e.resolveSelect(Gt).getBatchMaxItems(),s=(0,k.chunk)(t,r||25),n=[],i=[];if(!s.length)return[];for(const e of s)try{const t=await Z.API_FETCH({request:{path:"/batch/v1",method:"POST",data:{requests:e}}});i.push(...t.responses)}catch(t){n.push(t),i.push(...(0,k.times)(e.length,(0,k.constant)({body:t,status:500,headers:{}})))}if(n.length===s.length)throw n[0];return i}))},ee=Z;var te=r(77172);const re="/ithemes-security/v1/bans";function*se(e,t={}){let r,s;yield{type:he,queryId:e,queryParams:t};try{r=yield M({path:(0,te.addQueryArgs)(re,t),parse:!1}),s=yield K(r)}catch(r){return yield{type:Te,queryId:e,queryParams:t,error:r},r}return yield ue(e,t.context||"view",r,s,"replace"),yield{type:qe,queryId:e,queryParams:t,response:r},r}function*ne(e){const t=yield Y("ithemes-security/bans","getQueryParams",e);yield*se(e,t)}function*ie(e,t="append"){const r=yield Y("ithemes-security/bans","getQueryHeaderLink",e,"next");if(!r)return[];let s,n;yield{type:he,queryId:e};try{s=yield M({url:r.link,parse:!1}),n=yield K(s)}catch(t){return yield{type:Te,queryId:e,error:t},t}const i=(0,te.getQueryArg)(r.link,"context")||"view";return yield ue(e,i,s,n,t),yield{type:qe,queryId:e,response:s},s}function ue(e,t,r,s,n){return{type:_e,queryId:e,context:t,response:r,items:s,mode:n}}function oe(e){return{type:be,ban:e}}function le(e){return{type:ve,ban:e}}function ce(e,t){return{type:Re,ban:e,error:t}}function ae(e,t){return{type:Ae,ban:e,response:t}}function ye(e,t){return{type:Ne,self:e,ban:t}}function de(e,t){return{type:Qe,self:e,error:t}}function ge(e,t){return{type:Pe,self:e,response:t}}function fe(e){return{type:Ue,self:e}}function Ee(e,t){return{type:Le,self:e,error:t}}function pe(e){return{type:xe,self:e}}function*me(e,t){const r={method:"POST",data:t};let s;(0,te.isURL)(e)?r.url=e:r.path=`${re}/${e}`,yield le(t);try{s=yield M(r)}catch(e){return yield ce(t,e),e}return yield ae(t,s),yield oe(s),s}function*Ie(e,t){const r=(0,k.isObject)(e)?(0,B.Ng)(e):e;let s;yield ye(r,t);try{s=yield M({url:r,method:"PUT",data:t})}catch(e){return yield de(r,e),e}return yield ge(r,s),yield oe(s),s}function*Se(e){const t=(0,k.isObject)(e)?(0,B.Ng)(e):e;yield fe(t);try{yield M({url:t,method:"DELETE"})}catch(e){return yield Ee(t,e),e}return yield pe(t),null}const _e="RECEIVE_QUERY",he="START_QUERY",qe="FINISH_QUERY",Te="FAILED_QUERY",ve="START_CREATE_BAN",Ae="FINISH_CREATE_BAN",Re="FAILED_CREATE_BAN",be="RECEIVE_BAN",Ne="START_UPDATE_BAN",Pe="FINISH_UPDATE_BAN",Qe="FAILED_UPDATE_BAN",Ue="START_DELETE_BAN",xe="FINISH_DELETE_BAN",Le="FAILED_DELETE_BAN";var De=r(84156);const Ce=(0,w.createRegistrySelector)((e=>()=>e("ithemes-security/bans").getQueryResults("main"))),Fe=(0,De.A)(((e,t)=>{const r=(0,k.get)(e,["queries",t,"selves"],[]),s=e.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.queries[t],e.bySelf]));function Oe(e,t,r){return(0,k.find)((0,k.get)(e,["queries",t,"links"],[]),{rel:r})}function we(e,t,r){return(0,k.filter)((0,k.get)(e,["queries",t,"links"],[]),{rel:r})}function ke(e,t,r){return(0,k.get)(e,["queries",t,"headers",r])}function He(e,t){return(0,k.get)(e,["queryParams",t])}function Ve(e,t){return e.bySelf[t]}function Be(e,t){const r=(0,k.isObject)(t)?(0,B.Ng)(t):t;return e.updating.includes(r)}function Me(e,t){const r=(0,k.isObject)(t)?(0,B.Ng)(t):t;return e.deleting.includes(r)}function Ge(e,t){return e.querying.includes(t)}function*Ye(){yield $("ithemes-security/bans","query","main",{per_page:100})}var $e=r(50030);const je={bySelf:{},queries:{},queryParams:{},querying:[],creating:[],updating:[],deleting:[]},Ke="ithemes-security/bans";function*We(e){const t=`https://ithemes.com/wp-json/ithemes/v1/inline-help/itsec/${encodeURIComponent(e)}`,r=yield j(t,{credentials:"omit",referrer:"no-referrer"});if(!r.ok)return;if(r.status>=400)return;const s=yield K(r);yield{type:ze,topic:e,help:s}}function*Xe(e=!0){yield X("global",{enable_remote_help:e})}(0,w.register)((0,w.createReduxStore)(Ke,{controls:ee,actions:s,selectors:n,resolvers:i,reducer:function(e=je,t){switch(t.type){case _e:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,k.map)(t.items,B.Ng):[...(0,k.get)(e,["queries",t.queryId,"selves"],[]),...(0,k.map)(t.items,B.Ng)],headers:(0,k.fromPairs)(Array.from(t.response.headers.entries())),links:(0,$e.parse)(t.response.headers.get("link"),{extended:!0}).map((e=>({...e,rel:e.rel[0]})))}},bySelf:{...e.bySelf,...(0,k.fromPairs)(t.items.filter((r=>{const s=(0,B.Ng)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,B.Ng)(e),{context:t.context,item:e}])))}};case he:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]}};case qe:case Te:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case be:return{...e,bySelf:{...e.bySelf,[(0,B.Ng)(t.ban)]:{context:"edit",item:t.ban}}};case ve:return{...e,creating:[...e.creating,t.ban]};case Ae:case Re:return{...e,creating:e.creating.filter((e=>e!==t.ban))};case Ne:return{...e,updating:[...e.updating,t.self]};case Pe:case Qe:return{...e,updating:e.updating.filter((e=>e!==t.self))};case Ue:return{...e,deleting:[...e.deleting,t.self],bySelf:(0,k.omit)(e.bySelf,[t.self])};case xe:case Le:return{...e,deleting:e.deleting.filter((e=>e!==t.self))};default:return e}}}));const ze="RECEIVE_HELP",Je=[];function Ze(e,t){return e.byTopic[t]||Je}const et=(0,w.createRegistrySelector)((e=>()=>e("ithemes-security/modules").getSettings("global")?.enable_remote_help));function*tt(e){yield We(e)}const rt={byTopic:{}},st="ithemes-security/help",nt=(0,w.createReduxStore)(st,{controls:ee,actions:u,selectors:o,resolvers:l,reducer:function(e=rt,t){return t.type===ze?{...e,byTopic:{...e.byTopic,[t.topic]:t.help}}:e}});(0,w.register)(nt);var it=r(41795),ut=r(83846),ot=r(3075);const lt="ithemes-security/modules";function*ct(e,t){const r=yield w.controls.select(lt,"getModule",e);r?yield{type:Pt,module:e,edit:(0,it.A)(r,t)}:yield{type:Pt,module:e,edit:t}}function*at(e=!0){if(!0===e?e=yield w.controls.select(lt,"getDirtyModules"):(0,k.isString)(e)&&(e=[e]),!e.length)return[];const t=[];for(const r of e){const e=yield w.controls.select(lt,"getModuleEdits",r);t.push({method:"PUT",path:`/ithemes-security/v1/modules/${r}`,body:e})}let r;try{yield{type:Ut,modules:e},r=yield J(t)}catch(t){return yield{type:xt,modules:e},yield z("error",t.message),t}const s=[],n={};for(let i=0;i<t.length;i++){const t=e[i],u=r[i];u.status>=400?n[t]=u.body:(s.push(t),yield At(u.body))}return(0,k.isEmpty)(n)||(yield{type:xt,errors:n}),s.length&&(yield{type:Lt,modules:s}),r}function*yt(e=!0){!0===e?e=yield w.controls.select(lt,"getDirtyModules"):(0,k.isString)(e)&&(e=[e]),yield{type:Qt,modules:e}}function*dt(e){try{const t=yield qt(e,"active");yield At(t);const r=yield M({path:`/ithemes-security/v1/settings/${e}`});yield Rt(e,r),yield{type:Lt,modules:[e]},t.side_effects&&(yield Tt()),yield z("success",(0,ot.__)("Activated feature","better-wp-security"),{type:"snackbar"})}catch(t){yield{type:xt,errors:{[e]:t}}}}function*gt(e){try{const t=yield qt(e,"inactive");yield At(t),yield{type:Lt,modules:[e]},t.side_effects&&(yield Tt()),yield z("success",(0,ot.__)("Deactivated feature","better-wp-security"),{type:"snackbar"})}catch(t){yield{type:xt,errors:{[e]:t}}}}function*ft(e){const t={requests:(0,k.map)(e,((e,t)=>({path:`/ithemes-security/v1/modules/${t}`,method:"PUT",body:{status:{selected:e}}})))},r=yield J(t);for(let e=0;e<r.length;e++){const t=r[e];t.status>=400?yield z("error",t.body.message):yield At(t.body)}}function*Et(e,t){const r=yield w.controls.select(lt,"getSettings",e);if(!r)return void(yield{type:Ct,module:e,edit:t});const s={};let n=!1;for(const e in t)t.hasOwnProperty(e)&&((0,k.isEqual)(t[e],r[e])||(s[e]=t[e],n=!0));n?yield{type:Ct,module:e,edit:s}:(yield w.controls.select(lt,"getError",e))?yield{type:Ct,module:e,edit:t}:yield mt(e)}function*pt(e,t,r){const s=yield w.controls.select(lt,"getSetting",e,t);(0,k.isEqual)(s,r)?yield{type:Ot,module:e,setting:t}:yield{type:Ft,module:e,setting:t,value:r}}function*mt(e=!0){!0===e?e=yield w.controls.select(lt,"getDirtySettings"):(0,k.isString)(e)&&(e=[e]),yield{type:wt,modules:e}}function*It(e=!0,t=!1){if(!0===e?e=yield w.controls.select(lt,"getDirtySettings"):(0,k.isString)(e)&&(e=[e]),!e.length)return[];const r=[],s=[],n={};for(const i of e){if(t){const e=yield w.controls.dispatch(lt,"validateSettings",i);if(!0!==e){const t=new B.AR("local_validation_failed");e.errorText.forEach((e=>t.add("local_validation_failed",e))),n[i]=t;continue}}const e=yield w.controls.select(lt,"getSettingEdits",i);s.push(i),r.push({method:"PATCH",path:`/ithemes-security/v1/settings/${i}`,body:e})}let i;try{yield{type:kt,modules:e},i=yield J(r)}catch(t){return yield{type:Ht,modules:e},yield z("error",t.message),t}const u=[];for(let e=0;e<r.length;e++){const t=s[e],r=i[e];r.status>=400?n[t]=r.body:(u.push(t),yield Rt(t,r.body,B.Q7.fromResponseObject(r)))}return(0,k.isEmpty)(n)||(yield{type:Ht,errors:n}),u.length&&(yield z("success",(0,ot.__)("Saved settings.","better-wp-security"),{type:"snackbar"}),yield{type:Vt,modules:u}),i}function*St(e,t){let r;yield{type:kt,modules:[e]};try{r=yield M({path:`/ithemes-security/v1/settings/${e}`,method:"PATCH",data:t}),yield Rt(e,r)}catch(t){return yield{type:Ht,errors:{[e]:t}},t}return yield{type:Vt,modules:[e]},r}const _t=e=>async({select:t,resolveSelect:r})=>{const s=await r.getSettingsConditionalSchema(e);if(!s)return!0;const n=t.getEditedSettings(e),i=(0,B.qD)();return!!i.validate(s,n)||{errors:i.errors,errorText:ht(i.errors,e,s)}};function ht(e,t,r){const s=[];for(const{message:n,schemaPath:i,instancePath:u}of e){let e=ut.OG.create(i),o=e.parent(r);for(;o&&!o.title;)e=ut.OG.create(e.path.slice(0,e.path.length-1)),o=e.parent(r);o?.title?s.push(`${o.title} ${n}.`):s.push(`${t}${u} ${n}.`)}return s}function qt(e,t){return M({method:"PUT",path:`/ithemes-security/v1/modules/${e}`,data:{status:{selected:t}}})}function*Tt(){const e=yield M({path:"/ithemes-security/v1/modules?context=edit&_embed=1"});yield vt(e)}function vt(e){return{type:bt,modules:e}}function At(e){return{type:Nt,module:e}}function Rt(e,t,r={}){return{type:Dt,module:e,settings:t,result:r}}const bt="RECEIVE_MODULES",Nt="RECEIVE_MODULE",Pt="EDIT_MODULE",Qt="RESET_MODULE_EDITS",Ut="START_SAVING_MODULES",xt="FAILED_SAVING_MODULES",Lt="FINISH_SAVING_MODULES",Dt="RECEIVE_SETTINGS",Ct="EDIT_SETTINGS",Ft="EDIT_SETTING",Ot="RESET_SETTING_EDIT",wt="RESET_SETTING_EDITS",kt="START_SAVING_SETTINGS",Ht="FAILED_SAVING_SETTINGS",Vt="FINISH_SAVING_SETTINGS";var Bt=r(98616),Mt=r.n(Bt);const Gt="ithemes-security/core";function Yt(e){return e.modules}const $t=(0,De.A)((e=>e.modules.map((t=>({...t,...e.moduleEdits[t.id]||{}})))),(e=>[e.modules,e.moduleEdits])),jt=(0,De.A)(((e,t)=>{const r=Wt(e,t);return r?{...r,...e.moduleEdits[t]||{}}:null}),((e,t)=>[e.modules,e.moduleEdits[t]])),Kt=(0,De.A)((e=>e.modules.filter((e=>"active"===e.status.selected)).map((e=>e.id))),(e=>e.modules));function Wt(e,t){return e.modules.find((e=>e.id===t))}function Xt(e,t){return"active"===Wt(e,t)?.status.selected}function zt(e,t){return e.moduleEdits[t]}function Jt(e,t){return e.savingModules.includes(t)}function Zt(e){return Object.keys(e.moduleEdits)}function er(e,t){return!!e.moduleEdits[t]}function tr(e,t){var r;return null!==(r=e.settings[t])&&void 0!==r?r:{}}function rr(e,t,r){return e.settings[t]?.[r]}function sr(e,t){return e.settingEdits[t]}const nr=(0,De.A)(((e,t)=>({...e.settings[t]||{},...e.settingEdits[t]||{}})),((e,t)=>[e.settings[t],e.settingEdits[t]]));function ir(e,t,r){var s;return null!==(s=e.settingEdits[t]?.[r])&&void 0!==s?s:e.settings[t]?.[r]}function ur(e,t){return Array.isArray(t)?e.savingSettings.some((e=>t.includes(e))):e.savingSettings.includes(t)}function or(e){return Object.keys(e.settingEdits)}function lr(e,t){return e.settingEdits[t]&&!(0,k.isEmpty)(e.settingEdits[t])}function cr(e,t){return e.errors[t]}function ar(e,t){return e.results[t]}function yr(e){return e.settings}const dr=(0,De.A)((e=>(0,k.reduce)(e.settings,((t,r,s)=>(t[s]={...r,...e.settingEdits[s]||{}},t)),{})),(e=>[e.settings,e.settingEdits]));function gr(e,t,r){return Wt(e,t)?.settings?.schema.properties[r]}const fr=Mt()(((e,t,r,s,n,i,u,o)=>{const l={select:t,serverType:r,installType:s,featureFlags:n,activeModules:i,settings:u,userGroupsBySetting:o},c=t=>((e,t,r)=>{const{serverType:s,installType:n,activeModules:i,settings:u,featureFlags:o,userGroupsBySetting:l}=r;if(e["server-type"]&&!e["server-type"].includes(s))return!1;if(e["install-type"]&&e["install-type"]!==n)return!1;if(e["active-modules"])for(const t of e["active-modules"])if(!i.includes(t))return!1;if(e["user-groups"])for(const r of e["user-groups"])if(!l[t.id]?.[r]?.length)return!1;if(e["feature-flags"])for(const t of e["feature-flags"])if(!o?.includes(t))return!1;return!(e.settings&&!(0,B.qD)().compile(e.settings)(u))})(t,e,l),a=(t,r)=>r.properties?{...r,properties:Object.entries(r.properties).reduce(((r,[s,n])=>{const i=`${t}.${s}`;return e.settings.conditional[i]&&!c(e.settings.conditional[i])||(r[s]=a(i,n)),r}),{})}:r,y=Object.entries(e.settings.schema.properties).reduce(((t,[r,s])=>e.settings.interactive.includes(r)?(e.settings.conditional[r]&&!c(e.settings.conditional[r])||(t[r]=a(r,s)),t):t),{}),{id:d,...g}=e.settings.schema;return{...g,properties:y}})),Er=(0,w.createRegistrySelector)((e=>(t,r)=>{const s=jt(t,r);return s?.settings?fr(s,e,e(Gt).getServerType(),e(Gt).getInstallType(),e(Gt).getFeatureFlags(),Kt(t),nr(t,r),e("ithemes-security/user-groups-editor").getEditedGroupsBySetting()):null})),pr={modules:[],moduleEdits:{},savingModules:[],settings:{},settingEdits:{},savingSettings:[],errors:{},results:{}};function*mr(){yield Tt()}const Ir={*fulfill(e){const t=yield M({path:`/ithemes-security/v1/settings/${e}`});yield Rt(e,t)},isFulfilled:(e,t)=>e.settings.hasOwnProperty(t)},Sr={*fulfill(){yield w.controls.resolveSelect(lt,"getModules")},isFulfilled:e=>!(0,k.isEmpty)(e.settings)};function*_r(){yield w.controls.resolveSelect(lt,"__unstableGetAllSettings")}function*hr(){yield w.controls.resolveSelect(lt,"getModules")}const qr={*fulfill(){yield w.controls.resolveSelect(lt,"getModules")},isFulfilled:(e,t)=>e.modules.includes((e=>e.id===t))};function*Tr(){yield w.controls.resolveSelect(lt,"getModules")}function*vr(){yield w.controls.resolveSelect(lt,"getModules")}function*Ar(e){yield w.controls.resolveSelect(lt,"getSettings",e)}function*Rr(e){yield w.controls.resolveSelect(lt,"getSettings",e)}function*br(e){yield w.controls.resolveSelect(lt,"getSettings",e)}const Nr=(0,w.createReduxStore)(lt,{controls:ee,actions:c,selectors:a,resolvers:y,reducer:function(e=pr,t){switch(t.type){case bt:return{...e,modules:[...t.modules],settings:{...e.settings,...t.modules.reduce(((e,t)=>{const r=(0,k.get)(t,["_embedded","ithemes-security:settings",0]);return r?{...e,[t.id]:r}:e}),{})}};case Nt:return{...e,modules:e.modules.map((e=>e.id===t.module.id?t.module:e)),settings:{...e.settings,[t.module.id]:(0,k.get)(t.module,["_embedded","ithemes-security:settings",0],e.settings[t.module.id])}};case Pt:return{...e,moduleEdits:{...e.moduleEdits,[t.module]:t.edit}};case Qt:return{...e,moduleEdits:(0,k.omit)(e.moduleEdits,t.modules)};case Ut:return{...e,savingModules:[...e.savingModules,...t.modules]};case Lt:return{...e,savingModules:e.savingModules.filter((e=>!t.modules.includes(e))),moduleEdits:(0,k.omit)(e.moduleEdits,t.modules),errors:(0,k.omit)(e.errors,t.modules)};case xt:return{...e,savingModules:(0,k.without)(e.savingModules,...Object.keys(t.errors||{}),...t.modules||[]),errors:{...e.errors,...t.errors}};case Dt:return{...e,settings:{...e.settings,[t.module]:t.settings},results:{...e.results,[t.module]:t.result||{}}};case Ct:return{...e,settingEdits:{...e.settingEdits,[t.module]:t.edit}};case Ft:return{...e,settingEdits:{...e.settingEdits,[t.module]:{...e.settingEdits[t.module]||{},[t.setting]:t.value}}};case Ot:return{...e,settingEdits:{...e.settingEdits,[t.module]:(0,k.omit)(e.settingEdits[t.module]||{},t.setting)}};case wt:return{...e,settingEdits:(0,k.omit)(e.settingEdits,t.modules),errors:(0,k.omit)(e.errors,t.modules)};case kt:return{...e,savingSettings:[...e.savingSettings,...t.modules],results:(0,k.omit)(e.results,t.modules)};case Vt:return{...e,savingSettings:e.savingSettings.filter((e=>!t.modules.includes(e))),settingEdits:(0,k.omit)(e.settingEdits,t.modules),errors:(0,k.omit)(e.errors,t.modules)};case Ht:return{...e,savingSettings:(0,k.without)(e.savingSettings,...Object.keys(t.errors||{}),...t.modules||[]),errors:{...e.errors,...t.errors}};default:return e}},persist:["moduleEdits","settingEdits"]});(0,w.register)(Nr);const Pr=Nr;function*Qr(){const e=yield M({path:"/ithemes-security/v1/tools"});yield{type:Lr,tools:e}}function*Ur(e,t={}){let r;yield{type:Dr,tool:e,form:t};try{r=yield M({path:`/ithemes-security/v1/tools/${e}`,method:"POST",data:t,parse:!1})}catch(t){const r=yield W(B.Q7.fromResponse(t.getResponse()));return yield{type:Cr,tool:e,result:r},r}const s=yield W(B.Q7.fromResponse(r));return yield{type:Cr,tool:e,result:s},s}function*xr(e,t=!0){let r;yield{type:Fr,tool:e,enabled:t};try{r=yield M({path:`/ithemes-security/v1/tools/${e}`,method:"PUT",data:{enabled:t}})}catch(t){return yield{type:Or,tool:e,error:t},t}return yield{type:wr,tool:e,data:r},r}const Lr="RECEIVE_TOOLS",Dr="START_TOOL",Cr="FINISH_TOOL",Fr="START_TOGGLE_TOOL",Or="FAILED_TOGGLE_TOOL",wr="FINISH_TOGGLE_TOOL",kr="ithemes-security/tools",Hr=Mt()(((e,t)=>e.map((e=>t[e.slug]||e))),{maxSize:1}),Vr=(0,w.createRegistrySelector)((e=>t=>Hr(e(kr).getToolsConfig(),t.bySlug))),Br=(0,De.A)((e=>e.slugs.map((t=>e.bySlug[t]))),(e=>[e.bySlug,e.slugs])),Mr=Mt()((e=>e.reduce(((e,t)=>{for(const[r,s]of Object.entries(t.tools))e.push({slug:r,module:t.id,toggleable:!1,schedule:"",form:null,...s});return e}),[])),{maxSize:1}),Gr=(0,w.createRegistrySelector)((e=>()=>Mr(e(lt).getModules()))),Yr=(0,w.createRegistrySelector)((e=>(t,r)=>t.bySlug[r]||e(kr).getToolsConfig().find((e=>r===e.slug))));function $r(e){return e.running}function jr(e,t){return e.running.includes(t)}function Kr(e,t){return e.lastResult[t]}function Wr(e,t){return e.updating.includes(t)}function Xr(e,t){return e.lastError[t]}const zr={bySlug:{},slugs:[],running:[],lastResult:{},updating:[],lastError:{}};function*Jr(){yield Qr()}function*Zr(){yield w.controls.resolveSelect(kr,"getTools")}const es={*fulfill(){yield w.controls.resolveSelect(kr,"getTools")},isFulfilled:(e,t)=>!!e.bySlug[t]},ts=(0,w.createReduxStore)(kr,{controls:ee,actions:d,selectors:g,resolvers:f,reducer:function(e=zr,t){switch(t.type){case Lr:return{...e,bySlug:(0,k.keyBy)(t.tools,"slug"),slugs:(0,k.map)(t.tools,"slug")};case Dr:return{...e,running:[...e.running,t.tool]};case Cr:return{...e,running:(0,k.without)(e.running,t.tool),lastResult:{...e.lastResult,[t.tool]:t.result}};case Fr:return{...e,updating:[...e.updating,t.tool]};case Or:return{...e,updating:(0,k.without)(e.updating,t.tool),lastError:{...e.lastError,[t.tool]:t.error}};case wr:return{...e,updating:(0,k.without)(e.updating,t.tool),lastError:(0,k.omit)(e.lastError,t.tool),bySlug:{...e.bySlug,[t.tool]:t.data}};default:return e}}});(0,w.register)(ts);const rs=ts,ss="ithemes-security/vulnerabilities",ns="/ithemes-security/v1/site-scanner/vulnerabilities";function*is(e,t={}){let r,s;yield{type:ms,queryId:e,queryParams:t};try{r=yield M({path:(0,te.addQueryArgs)(ns,t),parse:!1}),s=yield K(r)}catch(r){return yield{type:Ss,queryId:e,queryParams:t,error:r},r}return yield fs(e,t.context||"view",r,s,"replace"),yield{type:Is,queryId:e,queryParams:t,response:r},s}function*us(e){const t=yield Y(ss,"getQueryParams",e);yield*is(e,t)}function*os(e,t="append"){return yield*cs(e,"prev",t)}function*ls(e,t="append"){return yield*cs(e,"next",t)}function*cs(e,t,r){const s=yield Y(ss,"getQueryHeaderLink",e,t);if(!s)return[];let n,i;yield{type:ms,queryId:e};try{n=yield M({url:s.link,parse:!1}),i=yield K(n)}catch(t){return yield{type:Ss,queryId:e,error:t},t}const u=(0,te.getQueryArg)(s.link,"context")||"view";return yield fs(e,u,n,i,r),yield{type:Is,queryId:e,response:n},n}function*as(e){return yield*gs(e,"ithemes-security:mute-vulnerability")}function*ys(e){return yield*gs(e,"ithemes-security:fix-vulnerability")}function*ds(e){return yield*gs(e,"ithemes-security:deactivate-vulnerable-software")}function*gs(e,t){const r="string"==typeof e?yield w.controls.select(ss,"getVulnerability",e):e,s=(0,B.TE)(r,t);if(!s)return;const n=(0,B.Ng)(r);yield{type:_s,rel:t,self:n};try{const e=yield M({url:s,method:"POST"});return yield{type:hs,rel:t,self:n},yield Es(e),e}catch(e){return yield{type:qs,rel:t,self:n,error:e},e}}function fs(e,t,r,s,n){return{type:ps,queryId:e,context:t,response:r,items:s,mode:n}}function Es(e){return{type:Ts,vulnerability:e}}const ps="RECEIVE_QUERY",ms="START_QUERY",Is="FINISH_QUERY",Ss="FAILED_QUERY",_s="START_ACTION",hs="FINISH_ACTION",qs="FAILED_ACTION",Ts="RECEIVE_VULNERABILITY",vs=(0,w.createRegistrySelector)((e=>()=>e(ss).getQueryResults("main"))),As=(0,De.A)(((e,t)=>{const r=(0,k.get)(e,["queries",t,"selves"],[]),s=e.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.queries[t],e.bySelf]));function Rs(e,t){return!!e.queries[t]}function bs(e,t,r){return(0,k.find)((0,k.get)(e,["queries",t,"links"],[]),{rel:(0,k.castArray)(r)})}function Ns(e,t,r){return(0,k.filter)((0,k.get)(e,["queries",t,"links"],[]),{rel:(0,k.castArray)(r)})}function Ps(e,t){return!!bs(e,t,"prev")}function Qs(e,t){return!!bs(e,t,"next")}function Us(e,t,r){return(0,k.get)(e,["queries",t,"headers",r])}function xs(e,t){return(0,k.get)(e,["queryParams",t])}function Ls(e,t){return e.bySelf[t]?.item}function Ds(e,t){return Ls(e,e.selfById[t])}function Cs(e,t){const r="string"==typeof t?Ls(e,t):t;return r?(0,k.reduce)(r._links,((e,t,r)=>t.reduce(((e,t)=>t.title?(e.push({rel:r,title:t.title,isDestructive:t.isDestructive||!1}),e):e),e)),[]):[]}function Fs(e,t){return e.querying.includes(t)}function Os(e,t){return Hs(e,t,"ithemes-security:mute-vulnerability")}function ws(e,t){return Hs(e,t,"ithemes-security:fix-vulnerability")}function ks(e,t){return Hs(e,t,"ithemes-security:deactivate-vulnerable-software")}function Hs(e,t,r){const s="string"==typeof t?t:(0,B.Ng)(t);return e.actions.includes(`${r}:${s}`)}function*Vs(){yield $(ss,"query","main",{per_page:100,resolution:["unresolved","patched","deactivated"]})}function*Bs(e){const t=yield M({path:`${ns}/${e}`});return yield Es(t),t}const Ms={bySelf:{},selfById:{},queries:{},queryParams:{},querying:[],actions:[]},Gs=(0,w.createReduxStore)(ss,{actions:E,selectors:p,resolvers:m,controls:ee,reducer:function(e=Ms,t){switch(t.type){case ps:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,k.map)(t.items,B.Ng):[...(0,k.get)(e,["queries",t.queryId,"selves"],[]),...(0,k.map)(t.items,B.Ng)],headers:(0,k.fromPairs)(Array.from(t.response.headers.entries())),links:(0,$e.parse)(t.response.headers.get("link"),{extended:!0})}},bySelf:{...e.bySelf,...(0,k.fromPairs)(t.items.filter((r=>{const s=(0,B.Ng)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,B.Ng)(e),{context:t.context,item:e}])))},selfById:{...e.selfById,...(0,k.fromPairs)(t.items.map((e=>[e.id,(0,B.Ng)(e)])))}};case ms:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]}};case Is:case Ss:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case Ts:return{...e,bySelf:{...e.bySelf,[(0,B.Ng)(t.vulnerability)]:{context:"edit",item:t.vulnerability}},selfById:{...e.selfById,[t.vulnerability.id]:(0,B.Ng)(t.vulnerability)}};case _s:return{...e,actions:[...e.actions,`${t.rel}:${t.self}`]};case hs:case qs:return{...e,actions:e.actions.filter((e=>e!==`${t.rel}:${t.self}`))};default:return e}}});(0,w.register)(Gs);const Ys=Gs,$s="ithemes-security/site-scanner",js="/ithemes-security/v1/site-scanner/scans";function*Ks(e,t={}){let r,s;yield{type:sn,queryId:e,queryParams:t};try{r=yield M({path:(0,te.addQueryArgs)(js,t),parse:!1}),s=yield K(r)}catch(r){return yield{type:un,queryId:e,queryParams:t,error:r},r}return yield tn(e,t.context||"view",r,s,"replace"),yield{type:nn,queryId:e,queryParams:t,response:r},r}function*Ws(e){const t=yield Y($s,"getQueryParams",e);yield*Ks(e,t)}function*Xs(e,t="append"){return yield*Js(e,"prev",t)}function*zs(e,t="append"){return yield*Js(e,"next",t)}function*Js(e,t,r){const s=yield Y($s,"getQueryHeaderLink",e,t);if(!s)return[];let n,i;yield{type:sn,queryId:e};try{n=yield M({url:s.link,parse:!1}),i=yield K(n)}catch(t){return yield{type:un,queryId:e,error:t},t}const u=(0,te.getQueryArg)(s.link,"context")||"view";return yield tn(e,u,n,i,r),yield{type:nn,queryId:e,response:n},n}function*Zs(e=0){yield{type:ln,siteId:e};try{const t=yield M({path:js,method:"POST",data:{site_id:e}});return yield en(t),yield{type:cn,siteId:e},t}catch(e){return yield{type:an,error:e},e}}function en(e){return{type:on,scan:e}}function tn(e,t,r,s,n){return{type:rn,queryId:e,context:t,response:r,items:s,mode:n}}const rn="RECEIVE_QUERY",sn="START_QUERY",nn="FINISH_QUERY",un="FAILED_QUERY",on="RECEIVE_SCAN",ln="START_SCAN",cn="FINISH_SCAN",an="FAILED_SCAN",yn=(0,w.createRegistrySelector)((e=>()=>e($s).getQueryResults("main"))),dn=(0,De.A)(((e,t)=>{const r=(0,k.get)(e,["queries",t,"selves"],[]),s=e.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.queries[t],e.bySelf]));function gn(e,t,r){return(0,k.find)((0,k.get)(e,["queries",t,"links"],[]),{rel:r})}function fn(e,t,r){return(0,k.filter)((0,k.get)(e,["queries",t,"links"],[]),{rel:r})}function En(e,t,r){return(0,k.get)(e,["queries",t,"headers",r])}function pn(e,t){return(0,k.get)(e,["queryParams",t])}function mn(e,t){return e.bySelf[t]?.item}function In(e,t){return e.querying.includes(t)}function Sn(e,t=0){return e.scanning===t}function*_n(){yield $($s,"query","main",{per_page:100})}const hn={bySelf:{},selfById:{},queries:{},queryParams:{},querying:[],scanning:null},qn=(0,w.createReduxStore)($s,{actions:I,selectors:S,resolvers:_,controls:ee,reducer:function(e=hn,t){switch(t.type){case rn:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,k.map)(t.items,B.Ng):[...(0,k.get)(e,["queries",t.queryId,"selves"],[]),...(0,k.map)(t.items,B.Ng)],headers:(0,k.fromPairs)(Array.from(t.response.headers.entries())),links:(0,$e.parse)(t.response.headers.get("link"),{extended:!0}).map((e=>({...e,rel:e.rel[0]})))}},bySelf:{...e.bySelf,...(0,k.fromPairs)(t.items.filter((r=>{const s=(0,B.Ng)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,B.Ng)(e),{context:t.context,item:e}])))}};case sn:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]}};case nn:case un:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case on:return{...e,bySelf:{...e.bySelf,[(0,B.Ng)(t.scan)]:{context:"edit",item:t.scan}}};case ln:return{...e,scanning:t.siteId};case cn:case an:return{...e,scanning:null};default:return e}}});(0,w.register)(qn);const Tn=qn,vn="ithemes-security/patchstack",An="https://itsec-site-scanner.ithemes.com";function*Rn(e,t={}){let r,s;yield{type:xn,queryId:e,queryParams:t},t.per_page=t.per_page||100,t.page=t.page||1;try{if(r=yield j((0,te.addQueryArgs)(An+"/db",t),{credentials:"omit"}),!r.ok)throw yield K(r);s=yield K(r)}catch(r){return yield{type:Dn,queryId:e,queryParams:t,error:r},r}return yield Un(e,t.context||"view",r,s,"replace"),yield{type:Ln,queryId:e,queryParams:t,response:r},r}function*bn(e){const t=yield w.controls.select(vn,"getQueryParams",e);yield*Rn(e,t)}function*Nn(e,t="append"){return yield*Qn(e,"prev",t)}function*Pn(e,t="append"){return yield*Qn(e,"next",t)}function*Qn(e,t,r){const s=yield w.controls.select(vn,"getQueryHeaderLink",e,t);if(!s)return[];let n,i;yield{type:xn,queryId:e};try{n=yield j(An+s.link,{credentials:"omit"}),i=yield K(n)}catch(t){return yield{type:Dn,queryId:e,error:t},t}const u=(0,te.getQueryArg)(s.link,"context")||"view";return yield Un(e,u,n,i,r),yield{type:Ln,queryId:e,response:n},n}function Un(e,t,r,s,n){return{type:Cn,queryId:e,context:t,response:r,items:s,mode:n}}const xn="START_QUERY",Ln="FINISH_QUERY",Dn="FAILED_QUERY",Cn="RECEIVE_QUERY",Fn=(0,w.createRegistrySelector)((e=>()=>e(vn).getQueryResults("main")));function On(e,t){return e.byId[t]}const wn=(0,De.A)(((e,t)=>{const r=(0,k.get)(e,["queries",t,"ids"],[]),s=e.byId,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.queries[t],e.byId]));function kn(e,t,r){return(0,k.find)((0,k.get)(e,["queries",t,"links"],[]),{rel:[r]})}function Hn(e,t,r){return(0,k.filter)((0,k.get)(e,["queries",t,"links"],[]),{rel:[r]})}function Vn(e,t,r){return(0,k.get)(e,["queries",t,"headers",r])}function Bn(e,t){return(0,k.get)(e,["queryParams",t])}function Mn(e,t){return kn(e,t,"next")}function Gn(e,t){return!!kn(e,t,"prev")}function Yn(e,t){return(0,k.get)(e,["errors",t])}function $n(e,t){return e.querying.includes(t)}function*jn(){yield $(vn,"query","main",{per_page:100})}const Kn={byId:{},queries:{},queryParams:{},querying:[],actions:[]},Wn=(0,w.createReduxStore)(vn,{controls:ee,actions:h,selectors:q,resolvers:T,reducer:function(e=Kn,t){switch(t.type){case Cn:return{...e,queries:{...e.queries,[t.queryId]:{ids:"replace"===t.mode?(0,k.map)(t.items,"id"):[...(0,k.get)(e,["queries",t.queryId,"ids"],[]),...(0,k.map)(t.items,"id")],headers:(0,k.fromPairs)(Array.from(t.response.headers.entries())),links:(0,$e.parse)(t.response.headers.get("link"),{extended:!0})}},byId:{...e.byId,...(0,k.fromPairs)(t.items.filter((r=>{const s=r.id;return!e.byId[s]||"embed"===e.byId[s].context||e.byId[s].context===t.context})).map((e=>[e.id,{context:t.context,item:e}])))}};case xn:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]},errors:(0,k.omit)(e.errors,[t.queryId])};case Ln:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case Dn:return{...e,querying:e.querying.filter((e=>e!==t.queryId)),errors:{...e.errors,[t.queryId]:t.error}};default:return e}}});(0,w.register)(Wn);const Xn=Wn;var zn=r(29672);const Jn="ithemes-security/users",Zn="/wp/v2/users",ei="/ithemes-security/v1/user-actions";function*ti(e,t={}){let r,s;yield{type:Si,queryId:e,queryParams:t};try{r=yield M({path:(0,te.addQueryArgs)(Zn,t),parse:!1}),s=yield K(r)}catch(r){return yield{type:hi,queryId:e,queryParams:t,error:r},r}return yield ui(e,t.context||"view",r,s,"replace"),yield{type:_i,queryId:e,queryParams:t,response:r},r}function*ri(e){const t=yield Y(Jn,"getQueryParams",e);yield*ti(e,t)}function*si(e,t="append"){return yield*ii(e,"prev",t)}function*ni(e,t="append"){return yield*ii(e,"next",t)}function*ii(e,t,r){const s=yield Y(Jn,"getQueryHeaderLink",e,t);if(!s)return[];let n,i;yield{type:Si,queryId:e};try{n=yield M({url:s.link,parse:!1}),i=yield K(n)}catch(t){return yield{type:hi,queryId:e,error:t},t}const u=(0,te.getQueryArg)(s.link,"context")||"view";return yield ui(e,u,n,i,r),yield{type:_i,queryId:e,response:n},n}function ui(e,t,r,s,n){return{type:Ii,queryId:e,context:t,response:r,items:s,mode:n}}function oi(e){return{type:Ai,user:e}}function*li(e,t,r){const s=yield Y(Jn,"getQueryParams",e),n=e;yield{type:qi,id:n};try{const e=yield M({path:ei,method:"POST",data:{query:s,mode:t,actions:r}});return yield{type:Ti,id:n},yield{type:Qi},yield{type:xi},yield ai(),e}catch(e){return yield{type:vi,id:n,error:e},e}}function*ci(e,t,r){yield{type:qi,id:r};try{const s=yield M({path:ei,method:"POST",data:{users:e,actions:t}});return yield{type:Ti,id:r},yield{type:Qi},yield{type:xi},yield ai(),s}catch(e){return yield{type:vi,id:r,error:e},e}}function ai(){return w.controls.dispatch(zn.store,"createNotice","info",(0,ot.__)("Quick edits are being applied in the background. This may take a few moments.","better-wp-security"),{id:"user_security_quick_edits_success",type:"snackbar",context:"ithemes-security"})}function*yi(e){switch(e){case"all":yield w.controls.dispatch(zn.store,"createNotice","info",(0,ot.__)("All users from the query are selected","better-wp-security"),{id:"user_security_all_selected",type:"snackbar",context:"ithemes-security"});break;case"window":yield w.controls.dispatch(zn.store,"createNotice","info",(0,ot.__)("Only the current page of users from the query are selected","better-wp-security"),{id:"user_security_page_selected",type:"snackbar",context:"ithemes-security"});break;case"none":yield w.controls.dispatch(zn.store,"createNotice","info",(0,ot.__)("None of the users from the query are selected","better-wp-security"),{id:"user_security_none_selected",type:"snackbar",context:"ithemes-security"}),yield{type:xi}}yield{type:Ri,userSelectionType:e}}function di(){return{type:Ni}}function gi(e){return{type:bi,user:e}}function fi(){return{type:xi}}function Ei(){return{type:Pi}}function pi(){return{type:Qi}}function mi(){return{type:Ui}}const Ii="RECEIVE_QUERY",Si="START_QUERY",_i="FINISH_QUERY",hi="FAILED_QUERY",qi="START_ACTION",Ti="FINISH_ACTION",vi="FAILED_ACTION",Ai="RECEIVE_USER",Ri="UPDATE_SELECTION_TYPE",bi="TOGGLE_SELECTED_USER",Ni="TOGGLE_SELECT_ALL",Pi="OPEN_QUICK_EDIT",Qi="CLOSE_QUICK_EDIT",Ui="CONFIRM_QUICK_EDIT",xi="REMOVE_SELECTED_USERS",Li=(0,w.createRegistrySelector)((e=>()=>e(Jn).getQueryResults("main"))),Di=(0,De.A)(((e,t)=>{const r=(0,k.get)(e,["queries",t,"selves"],[]),s=e.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.queries[t],e.bySelf]));function Ci(e,t,r){return(0,k.find)((0,k.get)(e,["queries",t,"links"],[]),{rel:(0,k.castArray)(r)})}function Fi(e,t,r){return(0,k.filter)((0,k.get)(e,["queries",t,"links"],[]),{rel:(0,k.castArray)(r)})}function Oi(e,t){return!!Ci(e,t,"prev")}function wi(e,t){return!!Ci(e,t,"next")}function ki(e,t,r){return(0,k.get)(e,["queries",t,"headers",r])}function Hi(e,t){return(0,k.get)(e,["queryParams",t])}function Vi(e,t){return e.bySelf[t]?.item}function Bi(e,t){return Vi(e,e.selfById[t])}function Mi(e){return e.userSelection}function Gi(e,t){return e.actions.includes(t)}function Yi(e,t){return e.actionErrors[t]}function $i(e){return e.selectedUsers}function ji(e){const t=Di(e,"main");return e.selectedUsers.length===t.length?"checked":e.selectedUsers.length>0?"indeterminate":"unchecked"}function Ki(e,t){return e.querying.includes(t)}function Wi(e,t){return e.selectedUsers.includes(t)}function Xi(e){return e.quickEditState}function zi(e){return e.actions}function*Ji(){yield $(Jn,"query","main",{per_page:20,context:"edit",roles:["administrator"]})}function*Zi(e){const t=yield M({path:`${Zn}/${e}?context=edit`});return yield oi(t),t}const eu={bySelf:{},selfById:{},userSelection:"window",queries:{},queryParams:{},querying:[],actions:[],actionErrors:{},selectedUsers:[],quickEditState:!1},tu=(0,w.createReduxStore)(Jn,{actions:v,selectors:A,resolvers:R,controls:ee,reducer:function(e=eu,t){switch(t.type){case Ii:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,k.map)(t.items,B.Ng):[...(0,k.get)(e,["queries",t.queryId,"selves"],[]),...(0,k.map)(t.items,B.Ng)],headers:(0,k.fromPairs)(Array.from(t.response.headers.entries())),links:(0,$e.parse)(t.response.headers.get("link"),{extended:!0})}},bySelf:{...e.bySelf,...(0,k.fromPairs)(t.items.filter((r=>{const s=(0,B.Ng)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,B.Ng)(e),{context:t.context,item:e}])))},selfById:{...e.selfById,...(0,k.fromPairs)(t.items.map((e=>[e.id,(0,B.Ng)(e)])))},selectedUsers:"main"===t.queryId?[]:e.selectedUsers};case Si:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]}};case _i:case hi:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case Ai:return{...e,bySelf:{...e.bySelf,[(0,B.Ng)(t.user)]:{context:"edit",item:t.user}},selfById:{...e.selfById,[t.user.id]:(0,B.Ng)(t.user)}};case Ri:return{...e,userSelection:t.userSelectionType};case Ni:const r=Di(e,"main");return e.selectedUsers.length===r.length?{...e,selectedUsers:[]}:{...e,selectedUsers:r.map((e=>e.id))};case bi:return e.selectedUsers.includes(t.user.id)?{...e,selectedUsers:e.selectedUsers.filter((e=>e!==t.user.id)),userSelection:"all"}:{...e,selectedUsers:[...e.selectedUsers,t.user.id],userSelection:"window"};case xi:return{...e,selectedUsers:[],userSelection:"none"};case Pi:return{...e,quickEditState:!0};case Qi:return{...e,quickEditState:!1};case Ui:return{...e,quickEditState:"confirm"};case qi:return{...e,actions:[...e.actions,t.id],actionErrors:(0,k.omit)(e.actionErrors,t.id)};case Ti:return{...e,actions:e.actions.filter((e=>e!==t.id))};case vi:return{...e,actions:e.actions.filter((e=>e!==t.id)),actionErrors:{...e.actionErrors,[t.id]:t.error}};default:return e}}});(0,w.register)(tu);const ru=tu,su="ithemes-security/firewall",nu="/ithemes-security/v1/firewall/rules",iu=(e,t={})=>async({dispatch:r})=>{let s,n;r({type:Su,queryId:e,queryParams:t});try{s=await V()({path:(0,te.addQueryArgs)(nu,t),parse:!1}),n=await s.json()}catch(s){return r({type:hu,queryId:e,queryParams:t,error:s}),s}return r(pu(e,t.context||"view",s,n,"replace")),r({type:_u,queryId:e,queryParams:t,response:s}),n},uu=e=>async({select:t,dispatch:r})=>{const s=t.getQueryParams(e);r.query(e,s)},ou=(e,t="append")=>(...r)=>cu(e,"prev",t)(...r),lu=(e,t="append")=>(...r)=>cu(e,"next",t)(...r),cu=(e,t,r)=>async({select:s,dispatch:n})=>{const i=s.getQueryHeaderLink(e,t);if(!i)return[];let u,o;n({type:Su,queryId:e});try{u=await V()({url:i.link,parse:!1}),o=await u.json()}catch(t){return n({type:hu,queryId:e,error:t}),t}const l=(0,te.getQueryArg)(i.link,"context")||"view";return n(pu(e,l,u,o,r)),n({type:_u,queryId:e,response:u}),u},au=(e,t)=>async({select:r,dispatch:s})=>{const n=r.getItem(e),i=r.getEditedItem(e);(0,k.isEqual)(n,{...i,...t})?s({type:"RESET_EDITS",self:e}):s({type:"EDIT_ITEM",self:e,edit:t})};function yu(e){return{type:"RESET_EDITS",self:e}}function du(){return{type:"RESET_ALL_EDITS"}}const gu=e=>async({select:t,dispatch:r})=>{const s=t.getEditedItem(e);if(!s||!t.isDirty(e))return s;const n=await r.saveItem(s);return r(yu(e)),n},fu=e=>async({dispatch:t})=>{const r=(0,B.Ng)(e);r&&t({type:"START_SAVING",self:r});try{const s=await V()({url:r,path:!r&&nu,method:r?"PUT":"POST",data:e});return t({type:"RECEIVE_ITEM",item:s}),r&&t({type:"FINISH_SAVING",self:r}),s}catch(e){throw r&&t({type:"FAILED_SAVING",self:r,error:e}),e}},Eu=e=>async({dispatch:t})=>{t({type:"START_DELETING",self:e});try{await V()({url:e,method:"DELETE"}),t({type:"FINISH_DELETING",self:e})}catch(r){t({type:"FAILED_DELETING",self:e,error:r})}};function pu(e,t,r,s,n){return{type:mu,queryId:e,context:t,response:r,items:s,mode:n}}const mu="RECEIVE_QUERY",Iu="RECEIVE_ITEM",Su="START_QUERY",_u="FINISH_QUERY",hu="FAILED_QUERY",qu=(0,w.createRegistrySelector)((e=>()=>e(su).getQueryResults("main"))),Tu=(0,De.A)(((e,t)=>{const r=(0,k.get)(e,["query","queries",t,"selves"],[]),s=e.query.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.query.queries[t],e.query.bySelf]));function vu(e,t,r){return(0,k.find)((0,k.get)(e,["query","queries",t,"links"],[]),{rel:(0,k.castArray)(r)})}function Au(e,t,r){return(0,k.filter)((0,k.get)(e,["query","queries",t,"links"],[]),{rel:(0,k.castArray)(r)})}function Ru(e,t){return!!vu(e,t,"prev")}function bu(e,t){return!!vu(e,t,"next")}function Nu(e,t,r){return(0,k.get)(e,["query","queries",t,"headers",r])}function Pu(e,t){return(0,k.get)(e,["query","queryParams",t])}function Qu(e,t){return e.query.bySelf[t]?.item}function Uu(e,t){return Qu(e,e.query.selfById[t])}function xu(e,t){return e.query.querying.includes(t)}const Lu=(0,De.A)(((e,t)=>e.query.bySelf[t]?.item&&{...e.query.bySelf[t].item,...e.edits.bySelf[t]||{}}),((e,t)=>[e.edits.bySelf[t],e.query.bySelf[t]]));function Du(e,t){return void 0!==e.edits.bySelf[t]}function Cu(e,t){const r="string"==typeof t?t:(0,B.Ng)(t);return e.saving.selves.includes(r)}function Fu(e,t){const r="string"==typeof t?t:(0,B.Ng)(t);return e.deleting.selves.includes(r)}function Ou(e,t){const r="string"==typeof t?t:(0,B.Ng)(t);return e.saving.errors[r]}function wu(e,t){const r="string"==typeof t?t:(0,B.Ng)(t);return e.deleting.errors[r]}const ku=()=>async({dispatch:e})=>{await e.query("main",{per_page:100,paused:"false"})},Hu={fulfill:e=>async({dispatch:t})=>{t({type:"RECEIVE_ITEM",item:await V()({url:(0,te.addQueryArgs)(e,{context:"edit"})})})},isFulfilled:(e,t)=>"edit"===e.query.bySelf[t]?.context},Vu={fulfill:e=>async({dispatch:t})=>{t({type:"RECEIVE_ITEM",item:await V()({path:`${nu}/${e}?context=edit`})})},isFulfilled:(e,t)=>!!e.query.selfById[t]},Bu={bySelf:{},selfById:{},queries:{},queryParams:{},querying:[]},Mu={bySelf:{}},Gu={selves:[],errors:{}},Yu=(0,w.combineReducers)({query:function(e=Bu,t){switch(t.type){case mu:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,k.map)(t.items,B.Ng):[...(0,k.get)(e,["queries",t.queryId,"selves"],[]),...(0,k.map)(t.items,B.Ng)],headers:(0,k.fromPairs)(Array.from(t.response.headers.entries())),links:(0,$e.parse)(t.response.headers.get("link"),{extended:!0})}},bySelf:{...e.bySelf,...(0,k.fromPairs)(t.items.filter((r=>{const s=(0,B.Ng)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,B.Ng)(e),{context:t.context,item:e}])))},selfById:{...e.selfById,...(0,k.fromPairs)(t.items.map((e=>[e.id,(0,B.Ng)(e)])))}};case Su:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]}};case _u:case hu:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case Iu:return{...e,bySelf:{...e.bySelf,[(0,B.Ng)(t.item)]:{context:"edit",item:t.item}},selfById:{...e.selfById,[t.item.id]:(0,B.Ng)(t.item)}};case"FINISH_DELETING":return{...e,bySelf:(0,k.omit)(e.bySelf,t.self),selfById:(0,k.omitBy)(e.selfById,(e=>e===t.self))};default:return e}},edits:function(e=Mu,t){switch(t.type){case"EDIT_ITEM":return{...e,bySelf:{...e.bySelf,[t.self]:{...e.bySelf[t.self]||{},...t.edit}}};case"RESET_EDITS":case"FINISH_DELETING":return{...e,bySelf:(0,k.omit)(e.bySelf,t.self)};case"RESET_ALL_EDITS":return{...e,bySelf:{}};default:return e}},saving:function(e=Gu,t){switch(t.type){case"START_SAVING":return{...e,selves:[...e.selves,t.self],errors:(0,k.omit)(e.errors,t.self)};case"FINISH_SAVING":return{...e,selves:e.selves.filter((e=>t.self!==e))};case"FAILED_SAVING":return{...e,selves:e.selves.filter((e=>t.self!==e)),errors:{...e.errors,[t.self]:t.error}};default:return e}},deleting:function(e=Gu,t){switch(t.type){case"START_DELETING":return{...e,selves:[...e.selves,t.self],errors:(0,k.omit)(e.errors,t.self)};case"FINISH_DELETING":return{...e,selves:e.selves.filter((e=>t.self!==e))};case"FAILED_DELETING":return{...e,selves:e.selves.filter((e=>t.self!==e)),errors:{...e.errors,[t.self]:t.error}};default:return e}}}),$u=(0,w.createReduxStore)(su,{actions:b,selectors:N,resolvers:P,reducer:Yu,controls:ee});(0,w.register)($u);const ju=$u,Ku="ithemes-security/logs",Wu="/ithemes-security/v1/logs";function*Xu(e,t={}){let r,s;yield{type:no,queryId:e,queryParams:t};try{r=yield M({path:(0,te.addQueryArgs)(Wu,t),parse:!1}),s=yield K(r)}catch(r){return yield{type:uo,queryId:e,queryParams:t,error:r},r}return yield to(e,t.context||"view",r,s,"replace"),yield{type:io,queryId:e,queryParams:t,response:r},s}function*zu(e){const t=yield Y(Ku,"getQueryParams",e);yield*Xu(e,t)}function*Ju(e,t="append"){return yield*eo(e,"prev",t)}function*Zu(e,t="append"){return yield*eo(e,"next",t)}function*eo(e,t,r){const s=yield Y(Ku,"getQueryHeaderLink",e,t);if(!s)return[];let n,i;yield{type:no,queryId:e};try{n=yield M({url:s.link,parse:!1}),i=yield K(n)}catch(t){return yield{type:uo,queryId:e,error:t},t}const u=(0,te.getQueryArg)(s.link,"context")||"view";return yield to(e,u,n,i,r),yield{type:io,queryId:e,response:n},n}function to(e,t,r,s,n){return{type:so,queryId:e,context:t,response:r,items:s,mode:n}}function ro(e){return{type:oo,log:e}}const so="RECEIVE_QUERY",no="START_QUERY",io="FINISH_QUERY",uo="FAILED_QUERY",oo="RECEIVE_LOG",lo=(0,w.createRegistrySelector)((e=>()=>e(Ku).getQueryResults("main"))),co=(0,De.A)(((e,t)=>{const r=(0,k.get)(e,["queries",t,"selves"],[]),s=e?.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e?.queries[t],e?.bySelf]));function ao(e,t,r){return(0,k.find)((0,k.get)(e,["queries",t,"links"],[]),{rel:(0,k.castArray)(r)})}function yo(e,t,r){return(0,k.filter)((0,k.get)(e,["queries",t,"links"],[]),{rel:(0,k.castArray)(r)})}function go(e,t){return!!ao(e,t,"prev")}function fo(e,t){return!!ao(e,t,"next")}function Eo(e,t,r){return(0,k.get)(e,["queries",t,"headers",r])}function po(e,t){return(0,k.get)(e,["queryParams",t])}function mo(e,t){return e.querying.includes(t)}function Io(e,t){return e.bySelf[t]?.item}function So(e,t){return Io(e,e.selfById[t])}function*_o(){yield $(Ku,"query","main",{per_page:100})}function*ho(e){const t=yield M({path:`${Wu}/${e}`});return yield ro(e),t}const qo={bySelf:{},selfById:{},queries:{},queryParams:{},querying:[]},To=(0,w.createReduxStore)(Ku,{actions:Q,selectors:U,resolvers:x,controls:ee,reducer:function(e=qo,t){switch(t.type){case so:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,k.map)(t.items,B.Ng):[...(0,k.get)(e,["queries",t.queryId,"selves"],[]),...(0,k.map)(t.items,B.Ng)],headers:(0,k.fromPairs)(Array.from(t.response.headers.entries())),links:(0,$e.parse)(t.response.headers.get("link"),{extended:!0})}},bySelf:{...e.bySelf,...(0,k.fromPairs)(t.items.filter((r=>{const s=(0,B.Ng)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,B.Ng)(e),{context:t.context,item:e}])))},selfById:{...e.selfById,...(0,k.fromPairs)(t.items.map((e=>[e.id,(0,B.Ng)(e)])))}};case no:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]}};case io:case uo:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case oo:return{...e,bySelf:{...e.bySelf,[(0,B.Ng)(t.log)]:{context:"edit",item:t.log}},selfById:{...e.selfById,[t.log.id]:(0,B.Ng)(t.log)}};default:return e}}});(0,w.register)(To);const vo=To,Ao="/ithemes-security/v1/trusted-devices",Ro=(e,t,r={})=>async({dispatch:s})=>{let n,i;s({type:Ho,queryId:e,userId:t,queryParams:r});try{n=await V()({path:(0,te.addQueryArgs)(Ao+"/"+t,r),parse:!1}),i=await n.json()}catch(t){return s({type:Bo,queryId:e,queryParams:r,error:t}),t}return s(Oo(e,r.context||"view",n,i,"replace")),s({type:Vo,queryId:e,queryParams:r,response:n}),i},bo=e=>async({select:t,dispatch:r})=>{const s=t.getQueryUser(e),n=t.getQueryParams(e);r.query(e,s,n)},No=(e,t="append")=>(...r)=>Qo(e,"prev",t)(...r),Po=(e,t="append")=>(...r)=>Qo(e,"next",t)(...r),Qo=(e,t,r)=>async({select:s,dispatch:n})=>{const i=s.getQueryHeaderLink(e,t);if(!i)return[];let u,o;n({type:Ho,queryId:e});try{u=await V()({url:i.link,parse:!1}),o=await u.json()}catch(t){return n({type:Bo,queryId:e,error:t}),t}const l=(0,te.getQueryArg)(i.link,"context")||"view";return n(Oo(e,l,u,o,r)),n({type:Vo,queryId:e,response:u}),u},Uo=(e,t)=>async({select:r,dispatch:s})=>{const n=r.getItem(e),i=r.getEditedItem(e);(0,k.isEqual)(n,{...i,...t})?s({type:"RESET_EDITS",self:e}):s({type:"EDIT_ITEM",self:e,edit:t})};function xo(e){return{type:"RESET_EDITS",self:e}}function Lo(){return{type:"RESET_ALL_EDITS"}}const Do=e=>async({select:t,dispatch:r})=>{const s=t.getEditedItem(e);if(!s||!t.isDirty(e))return s;const n=await r.saveItem(s);return r(xo(e)),n},Co=(e=!0)=>async({dispatch:t,registry:r,select:s})=>{!0===e&&(e=s.getDirtyItems());const n=e.map((e=>({method:"PUT",path:(0,B._t)(e),body:s.getEditedItem(e)})));e.forEach((e=>t({type:"START_SAVING",self:e})));const i=await async function(e,t){const r=await e.resolveSelect(Gt).getBatchMaxItems(),s=(0,k.chunk)(t,r||25),n=[];if(!s.length)return[];for(const e of s)try{const t=await V()({path:"/batch/v1",method:"POST",data:{requests:e}});n.push(...t.responses)}catch(t){n.push(...(0,k.times)(e.length,(0,k.constant)({body:t,status:500,headers:{}})))}return n}(r,n);for(let r=0;r<n.length;r++){const s=e[r],n=i[r];n.status>=400?t({type:"FAILED_SAVING",self:s,error:n.body}):(t({type:"FINISH_SAVING",self:s}),t({type:ko,item:n.body}))}return i},Fo=e=>async({dispatch:t})=>{const r=(0,B.Ng)(e);r&&t({type:"START_SAVING",self:r});try{const s=await V()({url:r,path:!r&&Ao,method:r?"PUT":"POST",data:e});return t({type:"RECEIVE_ITEM",item:s}),r&&t({type:"FINISH_SAVING",self:r}),s}catch(e){throw r&&t({type:"FAILED_SAVING",self:r,error:e}),e}};function Oo(e,t,r,s,n){return{type:wo,queryId:e,context:t,response:r,items:s,mode:n}}const wo="RECEIVE_QUERY",ko="RECEIVE_ITEM",Ho="START_QUERY",Vo="FINISH_QUERY",Bo="FAILED_QUERY",Mo=(0,De.A)(((e,t)=>{const r=(0,k.get)(e,["query","queries",t,"selves"],[]),s=e.query.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.query.queries[t],e.query.bySelf]));function Go(e,t,r){return(0,k.find)((0,k.get)(e,["query","queries",t,"links"],[]),{rel:(0,k.castArray)(r)})}function Yo(e,t,r){return(0,k.filter)((0,k.get)(e,["query","queries",t,"links"],[]),{rel:(0,k.castArray)(r)})}function $o(e,t){return!!Go(e,t,"prev")}function jo(e,t){return!!Go(e,t,"next")}function Ko(e,t,r){return(0,k.get)(e,["query","queries",t,"headers",r])}function Wo(e,t){return(0,k.get)(e,["query","queryParams",t])}function Xo(e,t){return(0,k.get)(e,["query","users",t])}function zo(e,t){return e.query.bySelf[t]?.item}function Jo(e,t){return zo(e,e.query.selfById[t])}function Zo(e,t){return e.query.querying.includes(t)}const el=(0,De.A)(((e,t)=>e.query.bySelf[t]?.item&&{...e.query.bySelf[t].item,...e.edits.bySelf[t]||{}}),((e,t)=>[e.edits.bySelf[t],e.query.bySelf[t]])),tl=(0,De.A)((e=>(0,k.reduce)(e.edits.bySelf,((e,t,r)=>((0,k.isEmpty)(t)||e.push(r),e)),[])),(e=>[e.edits]));function rl(e,t){return void 0!==e.edits.bySelf[t]}function sl(e,t){const r="string"==typeof t?t:(0,B.Ng)(t);return e.saving.selves.includes(r)}function nl(e){return e.saving.selves.length>0}function il(e,t){const r="string"==typeof t?t:(0,B.Ng)(t);return e.saving.errors[r]}const ul={bySelf:{},selfById:{},queries:{},queryParams:{},users:{},querying:[]},ol={bySelf:{}},ll={selves:[],errors:{}},cl=(0,w.combineReducers)({query:function(e=ul,t){switch(t.type){case wo:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,k.map)(t.items,B.Ng):[...(0,k.get)(e,["queries",t.queryId,"selves"],[]),...(0,k.map)(t.items,B.Ng)],headers:(0,k.fromPairs)(Array.from(t.response.headers.entries())),links:(0,$e.parse)(t.response.headers.get("link"),{extended:!0})}},bySelf:{...e.bySelf,...(0,k.fromPairs)(t.items.filter((r=>{const s=(0,B.Ng)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,B.Ng)(e),{context:t.context,item:e}])))},selfById:{...e.selfById,...(0,k.fromPairs)(t.items.map((e=>[e.id,(0,B.Ng)(e)])))}};case Ho:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]},users:{...e.users,[t.queryId]:t.userId}};case Vo:case Bo:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case ko:return{...e,bySelf:{...e.bySelf,[(0,B.Ng)(t.item)]:{context:"edit",item:t.item}},selfById:{...e.selfById,[t.item.id]:(0,B.Ng)(t.item)}};default:return e}},edits:function(e=ol,t){switch(t.type){case"EDIT_ITEM":return{...e,bySelf:{...e.bySelf,[t.self]:{...e.bySelf[t.self]||{},...t.edit}}};case"RESET_EDITS":return{...e,bySelf:(0,k.omit)(e.bySelf,t.self)};case"RESET_ALL_EDITS":return{...e,bySelf:{}};default:return e}},saving:function(e=ll,t){switch(t.type){case"START_SAVING":return{...e,selves:[...e.selves,t.self],errors:(0,k.omit)(e.errors,t.self)};case"FINISH_SAVING":return{...e,selves:e.selves.filter((e=>t.self!==e))};case"FAILED_SAVING":return{...e,selves:e.selves.filter((e=>t.self!==e)),errors:{...e.errors,[t.self]:t.error}};default:return e}}}),al=(0,w.createReduxStore)("ithemes-security/trusted-devices",{actions:L,selectors:D,reducer:cl,controls:ee});(0,w.register)(al);const yl=al,dl=(0,De.A)(((e,t)=>e.users.optimisticEdits[t]?(0,k.merge)((0,k.cloneDeep)(e.users.byId[t]),e.users.optimisticEdits[t]):e.users.byId[t]),((e,t)=>[e.users.byId[t],e.users.optimisticEdits[t]]));function gl(e){return dl(e,fl(e))}function fl(e){return e.users.currentId}function El(e,t){return e.users.saving.includes(t)}function pl(e){return El(e,e.users.currentId)}function ml(e){return e.index}function Il(e,t){const r=e.index;return r?(0,k.find)(r.routes,(e=>e?.schema?.title===t))?.schema:null}function Sl(e){return e.index?.roles||null}function _l(e){return e.index?.requirements_info||null}function hl(e){return e.actors.types}function ql(e,t){return e.actors.byType[t]}function Tl(e){return e.siteInfo}const vl=(0,w.createRegistrySelector)((e=>t=>e(lt).getSetting("feature-flags","enabled")||t.featureFlags));function Al(e){return e.batchMaxItems}function Rl(e){return e.index?.server_type||null}function bl(e){return e.index?.install_type||null}function Nl(e){return e.index?.has_patchstack||null}function Pl(e){return e.index?.is_lw_customer||null}function Ql(e){return e.adminUrl}function*Ul(e=!1){let t="/ithemes-security/v1?context=help";e&&(t+="&_="+Date.now());const r=yield M({path:t});return yield xl(r),r}function xl(e){return{type:Gl,index:e}}function*Ll(e,t=!1){yield*Dl("me",e,t)}function*Dl(e,t,r=!1){const s=yield Y("ithemes-security/core","getCurrentUserId");"me"===e&&(e=s);const n=`/wp/v2/users/${e===s?"me":e}`;yield{type:"START_SAVING_USER",id:e,data:t,optimistic:r};try{const r=yield M({method:"PUT",path:n,data:t});yield Fl(r),yield{type:"FINISH_SAVING_USER",id:e,user:r}}catch(t){yield{type:"FAILED_SAVING_USER",id:e,error:t}}}function*Cl(e){const t=yield Y("ithemes-security/core","getCurrentUserId"),r=yield M({path:`/wp/v2/users/${e===t?"me":e}?context=edit`});yield Fl(r)}function Fl(e){return{type:Yl,user:e}}function Ol(e){return{type:$l,userId:e}}function wl(e){return{type:jl,types:e}}function kl(e,t){return{type:Kl,actorType:e,actors:t}}function Hl(e){return{type:Wl,siteInfo:e}}function Vl(e){return{type:Xl,flags:e}}function Bl(e){return{type:zl,maxItems:e}}function Ml(e){return{type:Jl,adminUrl:e}}const Gl="RECEIVE_INDEX",Yl="RECEIVE_USER",$l="RECEIVE_CURRENT_USER_ID",jl="RECEIVE_ACTOR_TYPES",Kl="RECEIVE_ACTORS",Wl="RECEIVE_SITE_INFO",Xl="LOAD_INITIAL_FEATURE_FLAGS",zl="RECEIVE_BATCH_MAX_ITEMS",Jl="RECEIVE_ADMIN_URL";function*Zl(){const e=yield M({path:"/ithemes-security/v1?context=help"});yield xl(e)}const ec=()=>({resolveSelect:e})=>e.getIndex(),tc=()=>({resolveSelect:e})=>e.getIndex(),rc=()=>({resolveSelect:e})=>e.getIndex(),sc=()=>({resolveSelect:e})=>e.getIndex(),nc=()=>({resolveSelect:e})=>e.getIndex(),ic=()=>({resolveSelect:e})=>e.getIndex(),uc=()=>({resolveSelect:e})=>e.getIndex(),oc={*fulfill(e){const t=yield w.controls.select("ithemes-security/core","getCurrentUserId"),r=yield M({path:`/wp/v2/users/${e===t?"me":e}?context=edit`});yield Fl(r)},isFulfilled:(e,t)=>!!e.users.byId[t]},lc={*fulfill(){const e=yield M({path:"/wp/v2/users/me?context=edit"});yield Fl(e),yield Ol(e.id)},isFulfilled:e=>e.users.currentId&&e.users.byId[e.users.currentId]},cc={*fulfill(){const e=yield M({path:"/ithemes-security/v1/actors?_embed=1"}),t=[];for(const r of e){const e=(0,k.get)(r,["_embedded","wp:items",0],[]);yield kl(r.slug,e),t.push({slug:r.slug,label:r.label})}yield wl(t)},isFulfilled:e=>e.actors.types.length>0},ac={*fulfill(){yield w.controls.select("ithemes-security/core","getActorTypes")},isFulfilled:(e,t)=>!!e.actors.byType[t]},yc={*fulfill(){const e=yield M({path:"/?_fields=name,description,url,home,multisite"});yield Hl(e)},isFulfilled:e=>!!e.siteInfo};function*dc(){const e=yield M({path:"/batch/v1",method:"OPTIONS"});yield Bl(e.endpoints[0].args.requests.maxItems)}const gc={users:{currentId:0,byId:{},saving:[],optimisticEdits:{}},index:null,actors:{types:[],byType:{}},siteInfo:null,featureFlags:[],batchMaxItems:0,adminUrl:""};r.p=window.itsecWebpackPublicPath;const fc=(0,w.createReduxStore)(Gt,{controls:ee,selectors:C,resolvers:O,actions:F,reducer:function(e=gc,t){switch(t.type){case Gl:return{...e,index:t.index};case"START_SAVING_USER":return{...e,users:{...e.users,saving:[...e.users.saving,t.id],optimisticEdits:t.optimistic?{...e.users.optimisticEdits,[t.id]:t.data}:e.users.optimisticEdits}};case"FINISH_SAVING_USER":case"FAILED_SAVING_USER":return{...e,users:{...e.users,saving:e.users.saving.filter((e=>e!==t.id)),optimisticEdits:(0,k.omit)(e.users.optimisticEdits,t.id)}};case Yl:return{...e,users:{...e.users,byId:{...e.users.byId,[t.user.id]:t.user}}};case $l:return{...e,users:{...e.users,currentId:t.userId}};case jl:return{...e,actors:{...e.actors,types:t.types}};case Kl:return{...e,actors:{...e.actors,byType:{...e.actors.byType,[t.actorType]:t.actors}}};case Wl:return{...e,siteInfo:t.siteInfo};case Xl:return{...e,featureFlags:t.flags};case zl:return{...e,batchMaxItems:t.maxItems};case Jl:return{...e,adminUrl:t.adminUrl};default:return e}}});(0,w.register)(fc)}},e=>{e.O(0,[2038,9551,2932],(()=>e(e.s=96691)));var t=e.O();((window.itsec=window.itsec||{}).packages=window.itsec.packages||{}).data=t}]);