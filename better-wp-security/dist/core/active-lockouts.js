/*! For license information please see active-lockouts.js.LICENSE.txt */
(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[7802],{3075:e=>{e.exports=function(){return this.wp.i18n}()},8601:e=>{e.exports=function(){return this.wp.element}()},10424:e=>{e.exports=function(){return this.itsec.dashboard.dashboard}()},31987:e=>{e.exports=function(){return this.wp.data}()},37398:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ActiveLockout:()=>y,ActiveLockoutActions:()=>l,Detail:()=>v,List:()=>E,Search:()=>x,useActiveLockouts:()=>O,useBanLockout:()=>I,useReleaseLockout:()=>D});var n=r(51609),i=r(39959),s=r(3075),o=r(75596),a=r(10424);function l({isReleaseAvailable:e,selectedId:t,releasingIds:r,onRelease:l,isBannable:c,banningIds:u,onBan:d}){return(0,n.createElement)(a.CardFooter,null,(0,n.createElement)(o.g8,null),e&&(0,n.createElement)("span",null,(0,n.createElement)(i.Button,{variant:"primary","aria-disabled":r.includes(t),isBusy:r.includes(t),onClick:l},(0,s.__)("Release Lockout","better-wp-security"))),c&&(0,n.createElement)("span",null,(0,n.createElement)(i.Button,{variant:"primary","aria-disabled":u.includes(t),isBusy:u.includes(t),onClick:d},(0,s.__)("Ban","better-wp-security"))))}var c=r(26843),u=r(8601),d=r(89959),h=r(64716),f=r(81923);const m=(0,f.A)("div",{target:"e19hifs12"})({name:"wp0fdl",styles:"padding:0.5rem 1.25rem"}),p=(0,f.A)("li",{target:"e19hifs11"})({name:"a0377c",styles:"display:flex;align-items:center;gap:0.75rem"}),g=(0,f.A)(c.EY,{target:"e19hifs10"})("background-color:",(({theme:e})=>e.colors.surface.secondary),";padding:11px 6px;border-radius:2px;");function v({master:e={},isVisible:t,fetchLockoutDetails:r}){const i=(0,u.useMemo)((()=>e),[e]),s=(0,u.useCallback)((()=>r(e)),[r,e]),{value:o}=(0,h.Yb)(s,t);return(0,n.createElement)(m,null,(0,n.createElement)(y,{master:i}),o&&o.history.length>0&&(0,n.createElement)(w,{history:o.history}))}function y({master:e={}}){return(0,n.createElement)(n.Fragment,null,(0,n.createElement)(i.Tooltip,{text:(0,d.dateI18n)("M d, Y g:s A",e.start_gmt)},(0,n.createElement)("span",null,(0,n.createElement)(c.EY,{as:"time",size:c.$C.SMALL,textTransform:"capitalize",variant:c.J3.MUTED,text:(0,s.sprintf)((0,s.__)("%s ago","better-wp-security"),e.start_gmt_relative)}))),(0,n.createElement)(c.DZ,{level:3,size:c.$C.NORMAL,variant:c.J3.DARK,weight:c.uL.HEAVY,text:e.label}),(0,n.createElement)(c.EY,{variant:c.J3.DARK,text:e.description}))}function w({history:e}){return(0,n.createElement)(n.Fragment,null,(0,n.createElement)("hr",null),(0,n.createElement)("div",null,(0,n.createElement)(c.DZ,{level:4,size:c.$C.NORMAL,variant:c.J3.DARK,weight:c.uL.HEAVY,text:(0,s.__)("History","better-wp-security")}),(0,n.createElement)("ul",null,e.map((e=>(0,n.createElement)(b,{key:e.id,history:e}))))))}function b({history:e}){if(e.label)return(0,n.createElement)(p,{key:e.id},(0,n.createElement)(g,{as:"code"},e.label),(0,n.createElement)(i.Tooltip,{text:(0,d.dateI18n)("M d, Y g:s A",e.time)},(0,n.createElement)("span",null," ","â€¢"," ",(0,n.createElement)(c.EY,{as:"time",variant:c.J3.DARK,text:(0,s.sprintf)((0,s.__)("%s ago","better-wp-security"),e.time_relative)}))))}function E({lockouts:e,select:t,selectedLockout:r,fetchLockoutDetails:i}){return(0,n.createElement)(c.qj,{masters:e,getId:e=>e.id,isBorderless:!0,isSinglePane:!0,mode:"list",renderMaster:e=>(0,n.createElement)(y,{master:e}),onSelect:t,selectedId:r?.id||0,renderDetail:(e,t)=>(0,n.createElement)(v,{master:e,isVisible:t,fetchLockoutDetails:i})})}const k=(0,f.A)("div",{target:"e1i4g2bk0"})({name:"1dvcxr3",styles:"padding:1rem"});function x({searchTerm:e,setSearchTerm:t,isQuerying:r,query:i,queryId:o}){return(0,n.createElement)(k,null,(0,n.createElement)(c.qz,{placeholder:(0,s.__)("Search Lockouts","better-wp-security"),value:e,onChange:e=>{t(e),i(o,e?{search:e}:{})},isSearching:r,size:"small"}))}var L=r(31987),_=r(85631),A=r.n(_);function I(e){const[t,r]=(0,u.useState)([]),{createNotice:n,removeNotice:i}=(0,L.useDispatch)("core/notices"),o=e._links["ithemes-security:ban-lockout"]?.[0].href,a=!!o;return[t,(0,u.useCallback)((async e=>{const t=o.replace("{lockout_id}",e),a=`ban-lockout-${t}`;r((t=>[...t,e])),i(a,"ithemes-security");try{return await A()({url:t,method:"POST"}),setTimeout((()=>i(a,"ithemes-security")),5e3),n("success",(0,s.__)("Ban Created","better-wp-security"),{id:a,context:"ithemes-security"}),!0}catch(e){return n("error",(0,s.sprintf)((0,s.__)("Error when banning lockout: %s","better-wp-security"),e.message||(0,s.__)("An unexpected error occurred.","better-wp-security")),{id:a,context:"ithemes-security"}),!1}finally{r((t=>t.filter((t=>t!==e))))}}),[o,n,i]),a]}function D(e){const[t,r]=(0,u.useState)([]),{createNotice:n,removeNotice:i}=(0,L.useDispatch)("core/notices"),o=e._links["ithemes-security:release-lockout"]?.[0].href,a=!!o;return[t,(0,u.useCallback)((async e=>{const t=o.replace("{lockout_id}",e),a=`release-lockout-${t}`;r((t=>[...t,e])),i(a,"ithemes-security");try{return await A()({url:t,method:"DELETE"}),setTimeout((()=>i(a,"ithemes-security")),5e3),n("success",(0,s.__)("Lockout Released","better-wp-security"),{id:a,context:"ithemes-security"}),!0}catch(e){return n("error",(0,s.sprintf)((0,s.__)("Error when releasing lockout: %s","better-wp-security"),e.message||(0,s.__)("An unexpected error occurred.","better-wp-security")),{id:a,context:"ithemes-security"}),!1}finally{r((t=>t.filter((t=>t!==e))))}}),[o,n,i]),a]}function O(e){const[t,r]=(0,u.useState)(0),[n,i]=(0,u.useState)(""),[s,o,a]=I(e),[l,c,d]=D(e),h=(0,u.useCallback)((e=>{if(!e.links.item)return Promise.reject(new Error("No data available."));const t=e.links.item[0].href.replace("{lockout_id}",e.id);return A()({url:t}).then((e=>e.detail))}),[]),{isQuerying:f}=(0,L.useSelect)((t=>({isQuerying:t("ithemes-security/dashboard").isQueryingDashboardCard(e.id)})),[e.id]),{queryDashboardCard:m,refreshDashboardCard:p}=(0,L.useDispatch)("ithemes-security/dashboard");return{selectedId:t,searchTerm:n,setSearchTerm:i,isQuerying:f,query:m,select:e=>r(e),getDetails:h,onBan:async n=>{n.preventDefault();const i=await o(t);await p(e.id),i&&r((e=>e===t?0:e))},onRelease:async n=>{n.preventDefault();const i=await c(t);await p(e.id),i&&r((e=>e===t?0:e))},isBanAvailable:a,isReleaseAvailable:d,releasingIds:l,banningIds:s}}r.p=window.itsecWebpackPublicPath},39959:e=>{e.exports=function(){return this.wp.components}()},46627:e=>{e.exports=function(){return this.itsec.packages.data}()},46942:(e,t)=>{var r;!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var e="",t=0;t<arguments.length;t++){var r=arguments[t];r&&(e=o(e,s(r)))}return e}function s(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return i.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var r in e)n.call(e,r)&&e[r]&&(t=o(t,r));return t}function o(e,t){return t?e?e+" "+t:e+t:e}e.exports?(i.default=i,e.exports=i):void 0===(r=function(){return i}.apply(t,[]))||(e.exports=r)}()},51609:e=>{"use strict";e.exports=window.React},55933:e=>{e.exports=function(){return this.wp.primitives}()},57677:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(8601),i=(0,n.forwardRef)((({icon:e,size:t=24,...r},i)=>(0,n.cloneElement)(e,{width:t,height:t,...r,ref:i})))},62247:e=>{e.exports=function(){return this.wp.isShallowEqual}()},66087:e=>{"use strict";e.exports=window.lodash},70404:(e,t,r)=>{"use strict";function n(e){return"object"==typeof e&&null!=e&&1===e.nodeType}function i(e,t){return(!t||"hidden"!==e)&&"visible"!==e&&"clip"!==e}function s(e,t){if(e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth){var r=getComputedStyle(e,null);return i(r.overflowY,t)||i(r.overflowX,t)||function(e){var t=function(e){if(!e.ownerDocument||!e.ownerDocument.defaultView)return null;try{return e.ownerDocument.defaultView.frameElement}catch(e){return null}}(e);return!!t&&(t.clientHeight<e.scrollHeight||t.clientWidth<e.scrollWidth)}(e)}return!1}function o(e,t,r,n,i,s,o,a){return s<e&&o>t||s>e&&o<t?0:s<=e&&a<=r||o>=t&&a>=r?s-e-n:o>t&&a<r||s<e&&a>r?o-t+i:0}r.d(t,{A:()=>c});var a=function(e,t){var r=window,i=t.scrollMode,a=t.block,l=t.inline,c=t.boundary,u=t.skipOverflowHiddenElements,d="function"==typeof c?c:function(e){return e!==c};if(!n(e))throw new TypeError("Invalid target");for(var h,f,m=document.scrollingElement||document.documentElement,p=[],g=e;n(g)&&d(g);){if((g=null==(f=(h=g).parentElement)?h.getRootNode().host||null:f)===m){p.push(g);break}null!=g&&g===document.body&&s(g)&&!s(document.documentElement)||null!=g&&s(g,u)&&p.push(g)}for(var v=r.visualViewport?r.visualViewport.width:innerWidth,y=r.visualViewport?r.visualViewport.height:innerHeight,w=window.scrollX||pageXOffset,b=window.scrollY||pageYOffset,E=e.getBoundingClientRect(),k=E.height,x=E.width,L=E.top,_=E.right,A=E.bottom,I=E.left,D="start"===a||"nearest"===a?L:"end"===a?A:L+k/2,O="center"===l?I+x/2:"end"===l?_:I,S=[],C=0;C<p.length;C++){var N=p[C],R=N.getBoundingClientRect(),T=R.height,W=R.width,B=R.top,H=R.right,M=R.bottom,V=R.left;if("if-needed"===i&&L>=0&&I>=0&&A<=y&&_<=v&&L>=B&&A<=M&&I>=V&&_<=H)return S;var Y=getComputedStyle(N),j=parseInt(Y.borderLeftWidth,10),P=parseInt(Y.borderTopWidth,10),z=parseInt(Y.borderRightWidth,10),q=parseInt(Y.borderBottomWidth,10),J=0,Q=0,$="offsetWidth"in N?N.offsetWidth-N.clientWidth-j-z:0,F="offsetHeight"in N?N.offsetHeight-N.clientHeight-P-q:0,K="offsetWidth"in N?0===N.offsetWidth?0:W/N.offsetWidth:0,X="offsetHeight"in N?0===N.offsetHeight?0:T/N.offsetHeight:0;if(m===N)J="start"===a?D:"end"===a?D-y:"nearest"===a?o(b,b+y,y,P,q,b+D,b+D+k,k):D-y/2,Q="start"===l?O:"center"===l?O-v/2:"end"===l?O-v:o(w,w+v,v,j,z,w+O,w+O+x,x),J=Math.max(0,J+b),Q=Math.max(0,Q+w);else{J="start"===a?D-B-P:"end"===a?D-M+q+F:"nearest"===a?o(B,M,T,P,q+F,D,D+k,k):D-(B+T/2)+F/2,Q="start"===l?O-V-j:"center"===l?O-(V+W/2)+$/2:"end"===l?O-H+z+$:o(V,H,W,j,z+$,O,O+x,x);var Z=N.scrollLeft,G=N.scrollTop;D+=G-(J=Math.max(0,Math.min(G+J/X,N.scrollHeight-T/X+F))),O+=Z-(Q=Math.max(0,Math.min(Z+Q/K,N.scrollWidth-W/K+$)))}S.push({el:N,top:J,left:Q})}return S};function l(e){return e===Object(e)&&0!==Object.keys(e).length}const c=function(e,t){var r=e.isConnected||e.ownerDocument.documentElement.contains(e);if(l(t)&&"function"==typeof t.behavior)return t.behavior(r?a(e,t):[]);if(r){var n=function(e){return!1===e?{block:"end",inline:"nearest"}:l(e)?e:{block:"start",inline:"nearest"}}(t);return function(e,t){void 0===t&&(t="auto");var r="scrollBehavior"in document.body.style;e.forEach((function(e){var n=e.el,i=e.top,s=e.left;n.scroll&&r?n.scroll({top:i,left:s,behavior:t}):(n.scrollTop=i,n.scrollLeft=s)}))}(a(e,n),n.behavior)}}},74596:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(55933),i=r(74848),s=(0,i.jsx)(n.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,i.jsx)(n.Path,{d:"M7 11.5h10V13H7z"})})},77172:e=>{e.exports=function(){return this.wp.url}()},79860:e=>{e.exports=function(){return this.wp.keycodes}()},85631:e=>{e.exports=function(){return this.wp.apiFetch}()},89897:e=>{e.exports=function(){return this.wp.compose}()},89959:e=>{e.exports=function(){return this.wp.date}()},96126:e=>{e.exports=function(){return this.wp.deprecated}()}},e=>{e.O(0,[9427,6843,2038,9819,2932,3520,5596],(()=>e(e.s=37398)));var t=e.O();((window.itsec=window.itsec||{}).core=window.itsec.core||{})["active-lockouts"]=t}]);