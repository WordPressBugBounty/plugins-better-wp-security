(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[1841],{3075:e=>{e.exports=function(){return this.wp.i18n}()},8601:e=>{e.exports=function(){return this.wp.element}()},11431:e=>{e.exports=function(){return this.wp.a11y}()},17232:e=>{e.exports=function(){return this.wp.domReady}()},31987:e=>{e.exports=function(){return this.wp.data}()},32633:(e,t,n)=>{"use strict";n.d(t,{wn:()=>E,X$:()=>v});var l=n(58168),r=n(51609),o=n(54625),a=n(39959),i=n(3075),s=n(89897),c=n(8601),d=n(26843),u=n(64716),m=n(4319),p=n(81923),f=n(16718),h=n(61965);const g=(0,f.SL)(h.Ay),b=(0,p.A)(g,{target:"ejy4qm0"})(".itsec-rjsf-object-fieldset{display:grid;grid-template-columns:[label fields] minmax(0, 1fr);grid-template-rows:auto;grid-gap:.5rem 0;@media (min-width: ",(({theme:{breaks:e}})=>e.small),"px){grid-template-columns:[label] 10rem [fields] minmax(0, 1fr);}}.itsec-rjsf-section-description{margin-top:0;grid-column:fields;}>.field-object>.itsec-rjsf-object-fieldset{&>.itsec-rjsf-title-field,&>.itsec-rjsf-section-title{grid-column:label;font-size:1rem;padding-right:1rem;margin-top:0;&:not(:first-child){border-top:1px solid ",(({theme:e})=>e.colors.border.normal),";margin-top:.5rem;padding-top:1rem;@media (min-width: ",(({theme:{breaks:e}})=>e.small),"px){&+*{border-top:1px solid ",(({theme:e})=>e.colors.border.normal),";margin-top:.5rem;padding-top:1rem;}}}}&>.form-group:not(.field-object){grid-column:label/fields-end;}&>.itsec-rjsf-section-title~.form-group{grid-column:fields;}&>.itsec-rjsf-section-title:has(+ .itsec-highlighted-search-result){border-left:5px solid ",(({theme:e})=>e.colors.border.info),";background:#f9f7fd;margin-bottom:0;padding-top:1rem!important;}&>.field-object{grid-column:label/fields-end;}&>.field-description{margin-top:0;}}.itsec-rjsf-object-fieldset>*>.itsec-rjsf-object-fieldset{&>.itsec-rjsf-title-field{grid-column:label;font-size:1rem;padding-right:1rem;}&>.form-group{grid-column:fields;}&>.field-description{grid-column:fields;margin-top:0;}}.components-base-control__label,.components-input-control__label,label,caption,legend{color:",(({theme:e})=>e.colors.text.dark),";}.itsec-highlighted-search-result{background:#f9f7fd;padding-bottom:1rem;padding-top:1rem!important;.components-base-control__label,.components-input-control__label,label,caption{border-bottom:3px solid ",(({theme:e})=>e.colors.border.info),";padding-bottom:3px;margin-bottom:6px;}.components-base-control__field{margin-bottom:12px;}}.field-object:not(:first-child):not(:empty){border-top:1px solid ",(({theme:e})=>e.colors.border.normal),";margin-top:1rem;padding-top:1rem;}.field-object:empty{display:none;}.itsec-rjsf-title-field+.field-object:not(:first-child),.itsec-rjsf-section-description+.field-object:not(:first-child){border-top:none;margin-top:0;padding-top:0;}");function E({saveLabel:e,isSaving:t,saveDisabled:n,cancelLabel:o,onCancel:i,cancelRoute:c,undoLabel:d,undoDisabled:u,onUndo:p,children:f,errors:h,apiError:g,schemaError:b,withCard:x,alignActions:_,...w}){let C=(0,s.useInstanceId)(E,"itsec-schema-form");C=w.id||C;const S=(0,r.createElement)(r.Fragment,null,(0,r.createElement)(m.VS,{errors:h,apiError:g,schemaError:b}),(0,r.createElement)(v,(0,l.A)({},w,{id:C})));return(0,r.createElement)(a.Flex,{direction:"column",gap:7,justify:"start",expanded:!1},(0,r.createElement)(a.FlexItem,null,x&&(0,r.createElement)(a.Card,null,(0,r.createElement)(a.CardBody,null,S)),!x&&S),(0,r.createElement)(a.FlexItem,null,(0,r.createElement)(y,{id:C,saveLabel:e,cancelLabel:o,isSaving:t,saveDisabled:n,onCancel:i,cancelRoute:c,undoLabel:d,undoDisabled:u,onUndo:p,align:_},f)))}const v=(0,c.forwardRef)((({className:e,...t},n)=>(0,r.createElement)(b,(0,l.A)({},t,{ref:n,className:e}),(0,r.createElement)(r.Fragment,null))));function y({id:e,saveLabel:t=(0,i.__)("Save","better-wp-security"),isSaving:n,saveDisabled:l,cancelLabel:s=(0,i.__)("Cancel","better-wp-security"),onCancel:c,cancelRoute:p,undoLabel:f=(0,i.__)("Undo Changes","better-wp-security"),undoDisabled:h,onUndo:g,align:b,children:E}){return(0,r.createElement)(a.Flex,{align:b},c&&(0,r.createElement)(a.FlexItem,null,(0,r.createElement)(d.$n,{variant:"tertiary",type:"button",onClick:c},s)),p&&(0,r.createElement)(a.FlexItem,null,(0,r.createElement)(o.N_,{component:(0,u.kk)(d.$n),variant:"tertiary",type:"button",to:p},s)),!b&&(0,r.createElement)(m.g8,null),E,g&&(0,r.createElement)(a.FlexItem,null,(0,r.createElement)(d.$n,{variant:"secondary",disabled:h,onClick:g},f)),(0,r.createElement)(a.FlexItem,null,(0,r.createElement)(d.$n,{variant:"primary",isBusy:n,disabled:n||l,form:e,type:"submit"},t)))}},38125:e=>{e.exports=function(){return this.wp.plugins}()},39959:e=>{e.exports=function(){return this.wp.components}()},40747:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AfterImportExportToolsFill:()=>X,BeforeImportExportToolsFill:()=>U,ExportFill:()=>Y,PageContainer:()=>P,PageHeader:()=>y,ToolFill:()=>q});var l=n(51609),r=n(8601),o=n(17232),a=n.n(o),i=n(3075),s=n(81923),c=n(56347),d=n(7e3),u=n(79487),m=n(39959),p=n(38125),f=n(26843),h=n(4319),g=n(54625),b=n(47406),E=n(64716);const v=(0,s.A)(g.N_,{target:"e1jry2z10"})({name:"8dk3vg",styles:"margin-bottom:1rem"});function y(){const{pathname:e}=(0,c.zy)();return(0,l.createElement)("header",null,"/tools"!==e&&(0,l.createElement)(v,{to:"/tools",component:(0,E.kk)(f.$n),icon:b.A,variant:"tertiary",text:(0,i.__)("Back to list","better-wp-security")}),(0,l.createElement)(f.DZ,{level:1,text:(0,i.__)("Tools","better-wp-security"),weight:f.uL.NORMAL}),(0,l.createElement)(f.EY,{size:f.$C.SMALL,variant:f.J3.MUTED,text:(0,i.__)("Advanced tools to help you manage your site’s security.","better-wp-security")}))}var x=n(58168),_=n(46942),w=n.n(_),C=n(66087),S=n(89897),N=n(31987),A=n(46627),F=n(32633),k=n(62932);const O=(0,s.A)("div",{target:"e13vre548"})({name:"1cwpjew",styles:"display:grid;grid-template-columns:repeat( auto-fit, minmax(min(800px, 100%), 1fr) );gap:2rem;margin-top:1rem"}),L=(0,s.A)(m.Card,{target:"e13vre547"})("display:flex;flex-direction:column;margin-bottom:0.75rem;box-shadow:none!important;border:1px solid ",(({theme:e})=>e.colors.border.normal),";>div:first-child{display:flex;flex-direction:column;}"),j=(0,s.A)(f.DZ,{target:"e13vre546"})({name:"ol9ofu",styles:"font-size:0.875rem"}),I=(0,s.A)(m.CardBody,{target:"e13vre545"})({name:"v1mh8",styles:"flex-grow:2;display:flex;flex-direction:column"}),R=(0,s.A)("div",{target:"e13vre544"})({name:"1k0t4vh",styles:"width:90%"}),T=(0,s.A)(h.VK,{target:"e13vre543"})("font-size:0.75rem;color:",(({theme:e})=>e.colors.text.muted),";"),D=(0,s.A)("div",{target:"e13vre542"})({name:"l2ils0",styles:"flex:0 0 90%"}),$=(0,s.A)("div",{target:"e13vre541"})("display:flex;margin-top:auto;@media screen and (min-width: ",(({theme:e})=>e.breaks.medium),"px){flex-direction:",(({hasMessage:e})=>e?"column":"row"),";}"),B=(0,s.A)(f.Mf,{target:"e13vre540"})({name:"14mfhm0",styles:"margin:0.5rem 0"});function M(){const{tools:e,activeModules:t,isLoaded:n}=(0,N.useSelect)((e=>({tools:e(A.toolsStore).getResolvedTools(),activeModules:e(A.MODULES_STORE_NAME).getActiveModules(),isLoaded:e(A.toolsStore).hasFinishedResolution("getTools")})),[]),o=(0,r.useMemo)((()=>e.filter((e=>t.includes(e.module)&&!1!==e.available))),[e,t]);return(0,l.createElement)(O,null,o.length>0&&n&&o.map((e=>(0,l.createElement)(K,{key:e.slug,tool:e}))))}function K({tool:e,className:t,...n}){const{result:o,isRunning:a}=(0,N.useSelect)((t=>({result:t(A.toolsStore).getLastResult(e.slug),isRunning:t(A.toolsStore).isRunning(e.slug)})),[e.slug]),[i,s]=(0,r.useState)([]);return(0,r.useEffect)((()=>s([])),[e]),(0,l.createElement)(L,(0,x.A)({className:w()(t,"itsec-tool"),isRounded:!0,size:"small"},n),(0,l.createElement)(m.CardHeader,{size:"small"},(0,l.createElement)(j,{level:3,variant:f.J3.DARK,weight:600,text:e.title})),(0,l.createElement)(I,null,(0,l.createElement)(h.e4,{result:o,schemaError:i}),(0,l.createElement)(R,null,(0,l.createElement)(f.EY,{variant:f.J3.DARK,text:e.description}),e.help&&(0,l.createElement)(T,{content:e.help,tagName:"p"})),(0,l.createElement)(V,{tool:e.slug}),(0,l.createElement)(W,{tool:e,setSchemaError:s,isRunning:a})))}function W({tool:e,setSchemaError:t,isRunning:n}){const o=function(e){const{activeModules:t,settings:n}=(0,N.useSelect)((t=>({settings:(0,C.mapValues)(e.condition?.settings||{},((e,n)=>t(A.MODULES_STORE_NAME).getSettings(n))),activeModules:t(A.MODULES_STORE_NAME).getActiveModules()})),[e]);if(!e.condition)return!0;if(e.condition["active-modules"])for(const n of e.condition["active-modules"])if(!t?.includes(n))return!1;if(e.condition.settings){const t=(0,k.qD)();for(const[l,r]of Object.entries(e.condition.settings))if(!t.compile(r)(n[l]))return!1}return!0}(e),a=(0,S.useInstanceId)(W,"itsec-tool-form"),s=(0,r.useMemo)((()=>({disableInlineErrors:!0,tool:e.slug})),[e.slug]),{runTool:c}=(0,N.useDispatch)(A.toolsStore),d=!o&&e.condition?.description;return(0,l.createElement)($,{hasMessage:d},e.form&&o&&(0,l.createElement)(D,null,(0,l.createElement)(F.X$,{id:a,idPrefix:`itsec_tool_${e.slug}`,schema:e.form,uiSchema:e.form.uiSchema,formContext:s,showErrorList:!1,onError:t,onSubmit:({formData:n})=>{t([]),c(e.slug,n)}})),!o&&e.condition?.description&&(0,l.createElement)(B,{type:"warning",messages:[e.condition.description]}),(0,l.createElement)(m.Flex,{className:"itsec-tool__actions",justify:"flex-end",align:"flex-end"},(0,l.createElement)(m.FlexItem,null,(0,l.createElement)(f.$n,{variant:"primary",className:"itsec-tool__trigger",type:e.form?"submit":"button",form:e.form?a:void 0,onClick:e.form?void 0:()=>c(e.slug),isBusy:n,disabled:!o},(0,i.__)("Run","better-wp-security"))),(0,l.createElement)(V,{tool:e.slug,fillProps:{isActive:o},area:"actions"},(e=>r.Children.map(e,((e,t)=>(0,l.createElement)(r.Fragment,{key:t},e&&(0,l.createElement)(m.FlexItem,null,e))))))))}function q({tool:e,area:t="main",...n}){return(0,l.createElement)(m.Fill,(0,x.A)({name:`Tool${t}${e}`},n))}function V({tool:e,area:t="main",...n}){return(0,l.createElement)(m.Slot,(0,x.A)({name:`Tool${t}${e}`},n))}const P=(0,s.A)("div",{target:"e1h1ua4f1"})({name:"94gy5t",styles:"width:100%;max-width:1680px;align-self:center;padding:1rem 1.25rem"}),z=(0,s.A)(f.DZ,{target:"e1h1ua4f0"})({name:"akdqam",styles:"margin-top:1rem"}),{Slot:H,Fill:U}=(0,m.createSlotFill)("BeforeImportExportTools"),{Slot:J,Fill:X}=(0,m.createSlotFill)("AfterImportExportTools"),{Slot:G,Fill:Y}=(0,m.createSlotFill)("Export");function Z(){const[e,t]=(0,r.useState)(!1);return(0,l.createElement)(P,null,(0,l.createElement)(y,null),(0,l.createElement)(H,null,(e=>(0,l.createElement)(Q,{fills:e,setHasTools:t}))),e&&(0,l.createElement)(z,{level:2,size:f.$C.LARGE,variant:f.J3.DARK,weight:600,text:(0,i.__)("Additional Tools","better-wp-security")}),(0,l.createElement)(M,null),(0,l.createElement)(J,null))}function Q({fills:e,setHasTools:t}){return(0,r.useEffect)((()=>t(e.length>0)),[e,t]),e}function ee(){return(0,l.createElement)(G,null)}const te=(0,s.A)(f.ui,{target:"e1nmkgzj0"})({name:"1fttcpj",styles:"display:flex;flex-direction:column"});function ne({history:e}){return(0,l.createElement)(u.b,{theme:f.$f},(0,l.createElement)(c.Ix,{history:e},(0,l.createElement)(d.HX,{ReactRouterRoute:c.qh},(0,l.createElement)(te,{className:"itsec-tools",variant:f.ls.UNDER_PAGE},(0,l.createElement)(m.SlotFillProvider,null,(0,l.createElement)(p.PluginArea,null),(0,l.createElement)(m.Popover.Slot,null),(0,l.createElement)(h.Nr,null),(0,l.createElement)(c.dO,null,(0,l.createElement)(c.qh,{path:"/export",component:ee}),(0,l.createElement)(c.qh,{path:"/tools",component:Z}),(0,l.createElement)(c.qh,{path:"/"},(0,l.createElement)(c.rd,{to:"/tools"}))))))))}var le=n(75413);n.p=window.itsecWebpackPublicPath,(0,i.setLocaleData)({"":{}},"ithemes-security-pro");const re=(0,le.n)(document.location,{page:"itsec-tools"});a()((()=>{const e=document.getElementById("itsec-tools-root");e&&(0,r.createRoot)(e).render((0,l.createElement)(ne,{history:re}))}))},46627:e=>{e.exports=function(){return this.itsec.packages.data}()},47406:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var l=n(55933),r=n(74848),o=(0,r.jsx)(l.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,r.jsx)(l.Path,{d:"M20 11.2H6.8l3.7-3.7-1-1L3.9 12l5.6 5.5 1-1-3.7-3.7H20z"})})},51609:e=>{"use strict";e.exports=window.React},55933:e=>{e.exports=function(){return this.wp.primitives}()},61965:(e,t,n)=>{"use strict";n.d(t,{bV:()=>b,Ay:()=>U});var l={};n.r(l),n.d(l,{BaseInputTemplate:()=>u,ErrorListTemplate:()=>p,FieldTemplate:()=>v,ObjectFieldTemplate:()=>_,TitleFieldTemplate:()=>S});var r={};n.r(r),n.d(r,{CheckboxWidget:()=>A,CheckboxesWidget:()=>F,IncludeExcludeWidget:()=>$,RadioWidget:()=>R,SelectWidget:()=>j,TextareaWidget:()=>I,ToggleWidget:()=>N});var o={};n.r(o),n.d(o,{ApiSelectField:()=>H,EntitySelectField:()=>M,FileTreeField:()=>P,TextareaListField:()=>K});var a=n(66087),i=n(58168),s=n(51609),c=n(39959),d=n(75596);const u=function(e){const{id:t,label:n,value:l,readonly:r,disabled:o,onBlur:u,onFocus:m,options:p,onChange:f,schema:h,uiSchema:g={},...b}=e;p.inputType?b.type=p.inputType:b.type||("number"===h.type?(b.type="number",b.step="any"):"integer"===h.type?(b.type="number",b.step="1"):b.type="text"),p.autocomplete&&(b.autoComplete=p.autocomplete),h.multipleOf&&(b.step=h.multipleOf),void 0!==h.minimum&&(b.min=h.minimum),void 0!==h.maximum&&(b.max=h.maximum);const E=g["ui:description"]||h.description,v=p.emptyValue||"";return(0,s.createElement)(c.TextControl,(0,i.A)({label:n,help:(0,s.createElement)(d.VK,{noWrap:!0,content:E}),readOnly:r,disabled:o,value:l||""},(0,a.omit)(b,["autofocus","formContext","registry","rawErrors","hideLabel","hideError"]),{onChange:e=>f(""===e?v:e),onBlur:u&&(e=>u(b.id,e.target.value)),onFocus:m&&(e=>m(b.id,e.target.value))}))};var m=n(4319);function p({errors:e}){return(0,s.createElement)(m.VS,{errors:e.map((({stack:e}={})=>e)).filter((e=>!!e))})}var f=n(57936),h=n(3075),g=n(26843);function b({name:e,...t}){return(0,s.createElement)(c.Fill,(0,i.A)({name:`RjsfField${e}`},t))}function E({name:e,...t}){return(0,s.createElement)(c.Slot,(0,i.A)({name:`RjsfField${e}`},t))}function v(e){const{children:t,errors:n,hidden:l,schema:r,uiSchema:o={},formContext:a,onChange:i}=e;if(l)return null;const{resettable:d}=(0,f.$R)(o),u=o["ui:warning"];return(0,s.createElement)(y,e,t,(0,s.createElement)(E,{name:e.id,fillProps:e}),u&&(0,s.createElement)(g.Mf,{messages:[u],type:"warning"}),d&&(0,s.createElement)(c.Button,{className:"itsec-rjsf-reset-field",variant:"secondary",onClick:()=>i(r.default)},(0,h.__)("Restore Default","better-wp-security")),!0!==a?.disableInlineErrors&&n)}function y(e){const{id:t,classNames:n,disabled:l,label:r,onKeyChange:o,onDropPropertyClick:a,readonly:i,required:d,schema:u,uiSchema:m}=e,p=`${r} Key`,h=u.hasOwnProperty(f.Rr),{removable:g}=(0,f.$R)(m);return h&&!1!==g?(0,s.createElement)("div",{className:n},(0,s.createElement)("div",{className:"row"},(0,s.createElement)("div",{className:"col-xs-5 form-additional"},(0,s.createElement)(c.TextControl,{label:p,required:d,id:`${t}-key`,onBlur:e=>o(e.target.value)})),(0,s.createElement)("div",{className:"form-additional form-group col-xs-5"},e.children),(0,s.createElement)("div",{className:"col-xs-2"},(0,s.createElement)(c.Button,{icon:"no-alt",isDestructive:!0,disabled:l||i,onClick:a(r)})))):(0,s.createElement)("div",{className:n},e.children)}var x=n(8601);function _(e){const{schema:t,uiSchema:n,properties:l,registry:r,title:o,description:a,idSchema:i,required:c}=e;if(!l.length)return null;const u=(0,f.$R)(n),m=(0,f.$F)("TitleFieldTemplate",r,u),p=(0,f.$F)("DescriptionFieldTemplate",r,u),h=(n["ui:sections"]||[]).reduce(((e,n)=>({...e,[n.fields.find((e=>!!t.properties[e]))]:n})),{});return(0,s.createElement)("div",{className:"itsec-rjsf-object-fieldset",id:i.$id},o&&(0,s.createElement)(m,{id:(0,f.EH)(i),title:o,required:c,schema:t,uiSchema:n,registry:r}),a&&(0,s.createElement)(p,{id:(0,f.IR)(i),description:(0,s.createElement)(d.VK,{noWrap:!0,content:e.description}),schema:t,uiSchema:n,registry:r}),l.map((({name:e,content:t})=>h[e]?(0,s.createElement)(x.Fragment,{key:e},(0,s.createElement)("h3",{className:"itsec-rjsf-section-title"},h[e].title),h[e].description&&(0,s.createElement)("p",{className:"itsec-rjsf-section-description"},(0,s.createElement)(d.VK,{noWrap:!0,content:h[e].description})),t):t)),(0,f.Xl)(t,n,e.formData)&&(0,s.createElement)(w,{className:"object-property-expand",onClick:e.onAddClick(t),disabled:e.disabled||e.readonly}))}function w({className:e,onClick:t,disabled:n}){return(0,s.createElement)("div",{className:"row"},(0,s.createElement)("p",{className:`col-xs-3 col-xs-offset-9 text-right ${e}`},(0,s.createElement)(c.Button,{icon:"plus-alt2",className:"btn-add col-xs-12","aria-label":(0,h.__)("Add","better-wp-security"),tabIndex:"0",onClick:t,disabled:n})))}const C="*";function S(e){const{id:t,title:n,required:l}=e;return(0,s.createElement)("span",{className:"itsec-rjsf-title-field",id:t},n,l&&(0,s.createElement)("span",{className:"required"},C))}function N({schema:e,uiSchema:t={},id:n,value:l,disabled:r,readonly:o,label:a,onBlur:i,onFocus:u,onChange:m}){const p=(0,f.l1)(e),h=t["ui:description"]||e.description;return(0,s.createElement)(c.ToggleControl,{checked:l||!1,onChange:m,required:p,disabled:r,readOnly:o,label:a,help:(0,s.createElement)(d.VK,{noWrap:!0,content:h}),onBlur:i&&(e=>i(n,e.target.checked)),onFocus:u&&(e=>u(n,e.target.checked))})}function A({schema:e,uiSchema:t={},id:n,value:l,disabled:r,readonly:o,label:a,onBlur:i,onFocus:u,onChange:m}){const p=(0,f.l1)(e),h=t["ui:description"]||e.description;return(0,s.createElement)(c.CheckboxControl,{checked:l||!1,onChange:m,required:p,disabled:r,readOnly:o,label:a,help:(0,s.createElement)(d.VK,{noWrap:!0,content:h}),onBlur:i&&(e=>i(n,e.target.checked)),onFocus:u&&(e=>u(n,e.target.checked))})}function F(e){const{disabled:t,options:n,value:l,readonly:r,onChange:o,label:a,schema:i,uiSchema:c={}}=e,{enumOptions:u,enumDisabled:m=[],style:p}=n,f=c["ui:description"]||i.description,h=u.map((e=>({...e,disabled:m.includes(e.value),help:e.schema.description&&(0,s.createElement)(d.VK,{noWrap:!0,content:e.schema.description})})));return(0,s.createElement)(d.iI,{value:l||[],onChange:o,options:h,label:a||c["ui:title"]||i.title,help:(0,s.createElement)(d.VK,{noWrap:!0,content:f}),readOnly:r,disabled:t,style:p})}const k=new Set(["number","integer"]);function O(e,t){const{type:n,items:l}=e,r=function(e){return e.enum?e.enum:e.oneOf&&e.oneOf.every((e=>e.enum&&1===e.enum.length))?e.oneOf.map((e=>e.enum[0])):[]}(e);if(r.includes(t))return t;if(""!==t){if("array"===n&&l&&k.has(l.type))return t.map(f.i);if("boolean"===n)return"true"===t;if("number"===n||"integer"===n)return(0,f.i)(t);if(r.length>0){if(r.every((e=>"number"===(0,f.A6)(e))))return(0,f.i)(t);if(r.every((e=>"boolean"===(0,f.A6)(e))))return"true"===t}return t}}function L(e,t){return t?[].slice.call(e.target.options).filter((e=>e.selected)).map((e=>e.value)):e.target.value}const j=function(e){const{schema:t,uiSchema:n={},id:l,options:r,value:o,label:a,required:i,disabled:u,readonly:m,multiple:p,onChange:f,onBlur:h,onFocus:g,placeholder:b}=e,{enumOptions:E,enumDisabled:v}=r,y=p?[]:"",x=[];p||void 0!==t.default||x.push({value:"",label:b});for(const e of E)x.push({...e,disabled:v&&v.includes(e.value)});const _=n["ui:description"]||t.description;return(0,s.createElement)(c.SelectControl,{multiple:p,options:x,value:void 0===o?y:o,label:a,help:(0,s.createElement)(d.VK,{noWrap:!0,content:_}),required:i,disabled:u,readOnly:m,onChange:e=>f(O(t,e)),onBlur:h&&(e=>h(l,O(t,L(e,p)))),onFocus:g&&(e=>g(l,O(t,L(e,p))))})};function I({schema:e,uiSchema:t={},id:n,value:l,disabled:r,readonly:o,label:u,onBlur:m,onFocus:p,onChange:h,...g}){const b=(0,f.$R)(t),{rows:E,placeholder:v,description:y=e.description}=b;return(0,s.createElement)(c.TextareaControl,(0,i.A)({value:void 0===l?"":l,onChange:h,disabled:r,readOnly:o,label:u,help:(0,s.createElement)(d.VK,{noWrap:!0,content:y}),onBlur:m&&(e=>m(n,e.target.value)),onFocus:p&&(e=>p(n,e.target.value)),rows:E,placeholder:v},(0,a.without)(g,["autofocus","formContext","registry","rawErrors"])))}function R({schema:e,uiSchema:t={},id:n,options:l,value:r,label:o,required:a,disabled:i,readonly:u,onChange:m,onBlur:p,onFocus:f}){const{enumOptions:h}=l,g=t["ui:description"]||e.description;return(0,s.createElement)(c.RadioControl,{selected:r,options:h,label:o,help:(0,s.createElement)(d.VK,{noWrap:!0,content:g}),required:a,disabled:i,readOnly:u,onChange:t=>m(O(e,t)),onBlur:p&&(t=>p(n,O(e,t.target.value))),onFocus:f&&(t=>f(n,O(e,t.target.value)))})}var T=n(11431),D=n(79860);function $({id:e,disabled:t,options:n,value:l,onChange:r,schema:o,autofocus:i,readonly:d}){const{enumOptions:u,enumDisabled:m=[],excludeList:{title:p=(0,h.__)("Excluded","better-wp-security"),description:f=(0,h.__)("The list of items to exclude from the selection.","better-wp-security"),button:g=(0,h.__)("Include","better-wp-security")}={},includeList:{title:b=(0,h.__)("Included","better-wp-security"),description:E=(0,h.__)("The list of items to include in the selection.","better-wp-security"),button:v=(0,h.__)("Exclude","better-wp-security")}={},title:y=o.title,description:_=o.description}=n;(0,x.useEffect)((()=>{const e=u.map((e=>e.value)),t=l.filter((t=>e.includes(t)));t.length!==l.length&&r(t)}),[l,u,r]);const[w,C]=(0,a.partition)(u,(e=>!l.includes(e.value)));return(0,s.createElement)("div",{className:"itsec-rjsf-include-exclude-widget"},y&&(0,s.createElement)(c.BaseControl.VisualLabel,null,y),_&&(0,s.createElement)("p",null,_),(0,s.createElement)("div",{className:"itsec-rjsf-include-exclude-widget__sides",id:e},(0,s.createElement)(B,{id:e+"__exclude",options:w,label:p,description:f,button:g,disabled:t||d,disabledOptions:m,autofocus:i,onToggle:e=>{(0,T.speak)((0,h.sprintf)((0,h.__)("Moved %1$s to %2$s.","better-wp-security"),(0,a.find)(w,{value:e}).label,b)),r([...l,e])}}),(0,s.createElement)(B,{id:e+"__include",options:C,label:b,description:E,button:v,disabled:t||d,disabledOptions:m,onToggle:e=>{(0,T.speak)((0,h.sprintf)((0,h.__)("Moved %1$s to %2$s.","better-wp-security"),(0,a.find)(C,{value:e}).label,p)),r(l.filter((t=>t!==e)))}})))}function B({id:e,label:t,description:n,options:l,button:r,onToggle:o,disabled:i,disabledOptions:u=[],autofocus:m}){const p=e+"__option__",[f,h]=(0,x.useState)("");return f&&!(0,a.find)(l,{value:f})&&h(""),(0,s.createElement)("div",{className:"itsec-rjsf-include-exclude-widget__side"},(0,s.createElement)(c.BaseControl,{id:e,help:(0,s.createElement)(d.VK,{noWrap:!0,content:n}),className:"itsec-rjsf-include-exclude-widget__listbox"},(0,s.createElement)("span",{className:"components-base-control__label",id:e+"__label"},t),(0,s.createElement)(d.NL,{role:"listbox",id:e,active:f&&p+f,"aria-labelledby":e+"__label","aria-describedby":n&&e+"__help",onNavigate:e=>h(e.substr(p.length)),onKeyDown:({keyCode:e})=>{if(!f||e!==D.DELETE&&e!==D.BACKSPACE)return;const t=(0,a.findIndex)(l,{value:f}),n=t+1<l.length?t+1:t-1;o(f),h(l[n]?.value||"")},autoFocus:m},l.map((e=>(0,s.createElement)("div",{id:p+e.value,key:e.value,role:i||u.includes(e.value)?"presentation":"option","aria-selected":e.value===f||void 0,onClick:i||u.includes(e.value)?void 0:()=>h(e.value)},e.label))))),(0,s.createElement)(c.Button,{variant:"secondary",disabled:!f,className:"itsec-rjsf-include-exclude-widget__move",onClick:()=>o(f),"aria-keyshortcuts":"Delete Backspace"},r))}function M({uiSchema:e,schema:t,idSchema:n,name:l,formData:r,disabled:o,readonly:a,onChange:i}){const c=(0,f.$R)(e);return(0,s.createElement)(m.F5,{id:n.$id,value:r,disabled:o,readonly:a,onChange:i,isMultiple:"array"===t.type,label:e["ui:title"]||t.title||l,description:e["ui:description"]||t.description,path:c.path,query:c.query,labelAttr:c.labelAttr,idAttr:c.idAttr,searchArg:c.searchArg})}function K({uiSchema:e,schema:t,name:n,formData:l,disabled:r,readonly:o,onChange:a}){const i=e["ui:title"]||t.title||n,c=e["ui:description"]||t.description,u=(0,f.$R)(e),{rows:m,placeholder:p}=u;return(0,s.createElement)(d.KK,{label:i,help:(0,s.createElement)(d.VK,{noWrap:!0,content:c}),disabled:r,readonly:o,rows:m,value:l,onChange:a,placeholder:p})}var W=n(85631),q=n.n(W),V=n(77172);function P({idSchema:e,formData:t,onChange:n,uiSchema:l,schema:r,name:o,disabled:i,readonly:u,autofocus:m}){const p=e.$id,f=l["ui:title"]||r.title||o,g=l["ui:description"]||r.description,[b,E]=(0,x.useState)([]),[v,y]=(0,x.useState)("");(0,x.useEffect)((()=>{q()({path:(0,V.addQueryArgs)("/ithemes-security/rpc/file-change/file-tree",{directory:"/"})}).then(E)}),[]);const _=e=>{n(t.includes(e)?t.filter((t=>t!==e)):[...t,e])};return(0,s.createElement)("div",{className:"itsec-rjsf-file-tree"},g&&(0,s.createElement)(d.VK,{content:g,tagName:"p"}),(0,s.createElement)("div",{className:"itsec-rjsf-file-tree__controls"},(0,s.createElement)("div",null,(0,s.createElement)(d.PH,{tree:b,id:p,label:(0,h.__)("File Selector","better-wp-security"),active:v,setActive:y,onActivate:_,onLoad:async e=>{const t=await q()({path:(0,V.addQueryArgs)("/ithemes-security/rpc/file-change/file-tree",{directory:e})}),n=(0,a.cloneDeep)(b);(0,d.Ir)(n,(n=>{if(n.id===e)return n.children=t,d.Ir.halt})),E(n)}}),(0,s.createElement)(c.Button,{variant:"secondary",disabled:!v,className:"itsec-rjsf-file-tree__select",onClick:()=>_(v),"aria-keyshortcuts":"Enter Space"},(0,h.__)("Select","better-wp-security"))),(0,s.createElement)(d.KK,{value:t,onChange:n,className:"itsec-rjsf-file-tree__list",label:f,disabled:i,readonly:u,autoFocus:m})))}function z(e,t){return{value:e,label:t}}function H({uiSchema:e,schema:t,idSchema:n,name:l,formData:r,disabled:o,readonly:i,onChange:u}){const p=(0,f.$R)(e),{path:g,placeholder:b}=p,[E,v]=(0,x.useState)(null),[y,_]=(0,x.useState)(!0),w="array"===t.type;(0,x.useEffect)((()=>{g?q()({path:g}).then((e=>{v(e)})).finally((()=>_(!1))):_(!1)}),[g]);const C=(0,x.useCallback)((e=>new Promise((t=>{if(!E)return void t([]);const n=Object.entries(E).filter((([,t])=>t.toLowerCase().includes(e.toLowerCase()))).map((([e,t])=>z(e,t)));t(n)}))),[E]),S=(0,x.useMemo)((()=>E?w?r?r.filter((e=>E[e])).map((e=>z(e,E[e]))):[]:r&&E[r]?z(r,E[r]):null:w?[]:null),[r,E,w]),N=(0,x.useMemo)((()=>!E||Object.entries(E).map((([e,t])=>z(e,t)))),[E]),A=e?.["ui:description"]||t.description,F=e?.["ui:title"]||t.title||l;return(0,s.createElement)(c.BaseControl,{className:"itsec-api-select-field",label:F,help:A&&(0,s.createElement)(d.VK,{noWrap:!0,content:A}),id:n.$id},(0,s.createElement)(m.DW,{inputId:n.$id,classNamePrefix:"components-itsec-async-select-control",isDisabled:o||i,isLoading:y,isMulti:w,isClearable:!0,cacheOptions:!0,defaultOptions:N,loadOptions:C,value:S,onChange:e=>{u(w?(0,a.map)(e||[],"value"):e?.value||"")},placeholder:b||(0,h.__)("Select…","better-wp-security")}))}const U={templates:l,widgets:r,fields:o,validator:(0,n(62932).iY)()}},62247:e=>{e.exports=function(){return this.wp.isShallowEqual}()},66087:e=>{"use strict";e.exports=window.lodash},75413:(e,t,n)=>{"use strict";n.d(t,{n:()=>a});var l=n(17929),r=n(86663),o=n(66087);function a(e,t){const n=(0,l.zR)(),a=n=>{const o="string"==typeof n?(0,l.Rr)(n):n,a=(0,r.parse)(o.search?.substring(1))||{};return{...o,pathname:e.pathname,search:"?"+(0,r.stringify)({...a,path:o.pathname,...t})}};return{get length(){return n.length},get action(){return n.action},get location(){const e=(0,r.parse)(n.location.search.substring(1)),l=e.path||"/";return{...n.location,pathname:l,search:"?"+(0,r.stringify)((0,o.omit)(e,["path",Object.keys(t)]))}},createHref:e=>n.createHref(a(e)),push:(e,t)=>{n.push(a(e),t)},replace:(e,t)=>{n.replace(a(e),t)},go:(...e)=>n.go.apply(n,e),goBack:(...e)=>n.goBack.apply(n,e),goForward:(...e)=>n.goForward.apply(n,e),block:(...e)=>n.block.apply(n,e),listen(e){return n.listen((()=>{e(this.location,this.action)}))}}}},75795:e=>{"use strict";e.exports=window.ReactDOM},76154:e=>{"use strict";e.exports=window.moment},77172:e=>{e.exports=function(){return this.wp.url}()},79860:e=>{e.exports=function(){return this.wp.keycodes}()},85631:e=>{e.exports=function(){return this.wp.apiFetch}()},89897:e=>{e.exports=function(){return this.wp.compose}()},89959:e=>{e.exports=function(){return this.wp.date}()},96126:e=>{e.exports=function(){return this.wp.deprecated}()}},e=>{e.O(0,[9427,6843,2038,9819,8363,5152,4887,2932,3520,4319,5596],(()=>e(e.s=40747)));var t=e.O();((window.itsec=window.itsec||{}).pages=window.itsec.pages||{}).tools=t}]);