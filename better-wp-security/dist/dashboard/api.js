/*! For license information please see api.js.LICENSE.txt */
(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[7228],{2873:e=>{e.exports=function(){return this.wp.hooks}()},3075:e=>{e.exports=function(){return this.wp.i18n}()},8601:e=>{e.exports=function(){return this.wp.element}()},21020:(e,r,t)=>{"use strict";var a=t(51609),s=Symbol.for("react.element"),d=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function c(e,r,t){var a,d={},c=null,u=null;for(a in void 0!==t&&(c=""+t),void 0!==r.key&&(c=""+r.key),void 0!==r.ref&&(u=r.ref),r)n.call(r,a)&&!o.hasOwnProperty(a)&&(d[a]=r[a]);if(e&&e.defaultProps)for(a in r=e.defaultProps)void 0===d[a]&&(d[a]=r[a]);return{$$typeof:s,type:e,key:c,ref:u,props:d,_owner:i.current}}r.Fragment=d,r.jsx=c,r.jsxs=c},31169:(e,r,t)=>{"use strict";t.d(r,{CM:()=>O,In:()=>w,Jc:()=>b,LO:()=>g,QO:()=>l,TW:()=>B,ZG:()=>D,cJ:()=>R,ig:()=>p,ih:()=>E,lc:()=>H,m8:()=>f,mg:()=>T,nz:()=>y,q3:()=>S,rP:()=>h,tl:()=>C,uj:()=>A,wT:()=>m,yq:()=>v});var a=t(66087),s=t(98616),d=t.n(s),n=t(31987),i=t(3075),o=t(2873),c=t(8601),u=t(62932);const l=(0,c.createContext)({canManage:!1,installType:""});function h(){return(0,c.useContext)(l)}function y(){const{canCreate:e,canEdit:r}=(0,n.useSelect)((e=>({canCreate:e("ithemes-security/dashboard").canCreateDashboards(),canEdit:e("ithemes-security/dashboard").canEditDashboard(e("ithemes-security/dashboard").getViewingDashboardId())})),[]);return e||r}const b=Object.freeze(["wide","large","medium","mobile"]),D=Object.freeze({wide:4,large:3,medium:2,mobile:1}),f=400,A=20,g=Object.freeze(b.reduce(((e,r)=>({...e,[r]:f*D[r]+A*(D[r]-1)})),{}));function p(e){const r=b.find((r=>g[r]+A<=e));return D[r]*(f+A)}const _=["minW","minH","maxW","maxH"];function R(e,r){const t=(0,n.select)("ithemes-security/dashboard"),a={};for(const e in r){if(!r.hasOwnProperty(e))continue;const s=r[e];for(const r of s){const s=t.getDashboardCard(parseInt(r.i));s&&(a[s.id]?(a[s.id].size[e]={w:r.w,h:r.h},a[s.id].position[e]={x:r.x&&r.x!==1/0?r.x:0,y:r.y&&r.y!==1/0?r.y:0}):a[s.id]={id:s.id,card:s.card,size:{[e]:{w:r.w,h:r.h}},position:{[e]:{x:r.x&&r.x!==1/0?r.x:0,y:r.y&&r.y!==1/0?r.y:0}}})}}return{cards:Object.values(a)}}function E(e,r,{cards:t={}}){const s=(0,a.zipObject)(Object.keys(g),(0,a.times)(Object.keys(g).length,(()=>[]))),d={};for(const r of t){d[r.id]=!0;const t=(0,n.select)("ithemes-security/dashboard").getAvailableCard(r.card);if(t||"unknown"===r.card)for(const a of b)s[a].push(C(e,r,t,a,s[a]))}if(Object.keys(d).length<r.length)for(const t of r)if(!d[t.id]){const r=(0,n.select)("ithemes-security/dashboard").getAvailableCard(t.card);if(r)for(const a of b)s[a].push(C(e,t,r,a,s[a]))}return s}function C(e,r,t,s,d){if(!g[s])return;const i={i:r.id.toString(),x:(0,a.get)(r,["position",s,"x"]),y:(0,a.get)(r,["position",s,"y"]),w:(0,a.get)(r,["size",s,"w"],(0,a.get)(t,["size","defaultW"],1)),h:(0,a.get)(r,["size",s,"h"],(0,a.get)(t,["size","defaultH"],2))};if(t&&t.size)for(const e of _)t.size.hasOwnProperty(e)&&(i[e]=t.size[e]);if(i.minW&&i.minW>i.w&&(i.w=i.minW),i.minH&&i.minH>i.h&&(i.h=i.minH),i.maxW&&i.w>i.maxW&&(i.w=i.maxW),i.maxH&&i.h>i.maxH&&(i.h=i.maxH),d&&void 0===i.x&&void 0===i.x){const e=S(D[s],d,{w:i.w,h:i.h});e&&(i.x=e.x,i.y=e.y)}return i.x=void 0===i.x||null===i.x?0:i.x,i.y=void 0===i.y||null===i.y?1/0:i.y,(0,n.select)("ithemes-security/dashboard").canEditDashboard(e)||(i.static=!0),"unknown"===r.card&&(i.isResizable=!1),i.minW===i.maxW&&i.minH===i.maxH&&(i.isResizable=!1),i}function S(e,r,t){const a=[];for(const t of r){const{x:r,y:s,w:d,h:n}=t;for(let t=0;t<n;t++){a[t]||(a[t]=new Array(e).fill(0));for(let n=0;n<d;n++)a[t+s]||(a[t+s]=new Array(e).fill(0)),a[t+s][n+r]=1}}const{w:s,h:d}=t;for(let r=0;r<a.length;r++)e:for(let t=0;t<e;t++)if(!a[r]||1!==a[r][t]){for(let n=0;n<d;n++)for(let d=0;d<s;d++)if(r+n>a.length||t+d>=e||a[r+n]&&1===a[r+n][t+d])continue e;return{x:t,y:r}}return{x:0,y:a.length}}function I(e,r){return e.x===r.x&&e.y===r.y&&e.w===r.w&&e.h===r.h}const v=d()((function(e,r){if(e===r)return!0;if(Object.keys(e).length!==Object.keys(r).length)return!1;const t=new Map;for(let a=0;a<b.length;a++){const s=b[a];if(e[s]||r[s]){if(!e[s]&&r[s]||e[s]&&!r[s])return!1;if(e[s].length!==r[s].length)return!1;for(let r=0;r<e[s].length;r++)t.set(e[s][r].i,e[s][r]);for(let e=0;e<r[s].length;e++){const a=t.get(r[s][e].i);if(!a)return!1;if(!I(a,r[s][e]))return!1;t.delete(a.i)}if(t.size>0)return!1}}return!0})),m=d()((function(e,r,t){const s=(0,a.keyBy)(r[t],"i"),d=[...e];return d.sort((function(e,r){const t=e.id.toString(),a=r.id.toString();if(!s[t]&&!s[a])return 0;if(s[t]&&!s[a])return 1;if(!s[t]&&s[a])return-1;const d=s[t].y,n=s[a].y,i=s[t].x,o=s[a].x;return d>n?1:d<n?-1:i>o?1:i<o?-1:0})),d})),O=d()((function(e,r){const t=(0,a.keyBy)(r.cards,"id"),s=[...e];return s.sort((function(e,r){const a=e.id,s=r.id;if(!t[a]&&!t[s])return 0;if(t[a]&&!t[s])return 1;if(!t[a]&&t[s])return-1;if(!t[a].position.mobile&&!t[s].position.mobile)return 0;const d=t[a].position.mobile.y,n=t[s].position.mobile.y,i=t[a].position.mobile.x,o=t[s].position.mobile.x;return d>n?1:d<n?-1:i>o?1:i<o?-1:0})),s}));function H(e,r){if(!r)return(0,i.__)("Unknown Card","better-wp-security");let t=r.label;return t=(0,o.applyFilters)(`ithemes-security.dashboard.getCardTitle.${r.slug}`,t,e),(0,o.applyFilters)("ithemes-security.dashboard.getCardTitle",t,e,r)}function T(e){if(e){if("global"===e.id)return"/settings/global";if("custom"!==e.type&&"tool"!==e.type&&"recommended"!==e.type){if("advanced"===e.type)return`/settings/advanced#${e.id}`;if("always-active"!==e.status?.default||e.settings?.show_ui)return`/settings/configure/${e.type}#${e.id}`}}}function w(e,r,t,a){Object.entries(t).forEach((([r,t])=>e[r]!==t&&console.log(`Prop '${r}' changed`))),Object.entries(a).forEach((([e,t])=>r[e]!==t&&console.log(`State '${e}' changed`)))}function B(e){return(0,a.get)(e,["avatar_urls",96],u.Z$)}},31987:e=>{e.exports=function(){return this.wp.data}()},39959:e=>{e.exports=function(){return this.wp.components}()},50030:function(e,r,t){var a,s,d,n;d=function(){var e=/^;\s*([^"=]+)=(?:"([^"]+)"|([^";,]+)(?:[;,]|$))/,r=/^<([^>]*)>/,t=/^\s*,\s*/;return{parse:function(a,s){for(var d,n,i,o=s&&s.extended||!1,c=[];a&&(a=a.trim(),n=r.exec(a));){for(var u={link:n[1]},l=(a=a.slice(n[0].length)).match(t);a&&(!l||l.index>0)&&(d=e.exec(a));)l=(a=a.slice(d[0].length)).match(t),"rel"===d[1]||"rev"===d[1]?(i=(d[2]||d[3]).split(/\s+/),u[d[1]]=i):u[d[1]]=d[2]||d[3];c.push(u),a=a.replace(t,"")}return o?c:c.reduce((function(e,r){return r.rel&&r.rel.forEach((function(t){e[t]=r.link})),e}),{})},stringify:function(e){var r=Object.keys(e).reduce((function(r,t){return r[e[t]]=r[e[t]]||[],r[e[t]].push(t),r}),{});return Object.keys(r).reduce((function(e,t){return e.concat("<"+t+'>; rel="'+r[t].join(" ")+'"')}),[]).join(", ")}}},n=this,e.exports?e.exports=d():"function"==typeof n.define&&n.define.amd?void 0===(s="function"==typeof(a=d)?a.call(r,t,r,e):a)||(e.exports=s):n.li=d()},51609:e=>{"use strict";e.exports=window.React},58168:(e,r,t)=>{"use strict";function a(){return a=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var a in t)({}).hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},a.apply(null,arguments)}t.d(r,{A:()=>a})},62247:e=>{e.exports=function(){return this.wp.isShallowEqual}()},66087:e=>{"use strict";e.exports=window.lodash},66885:(e,r,t)=>{"use strict";t.r(r),t.d(r,{AdminBarFill:()=>Zt,AdminBarSlot:()=>Xt,BelowToolbarFill:()=>ea,BelowToolbarSlot:()=>ra,EditCardsFill:()=>ta,EditCardsSlot:()=>aa});var a={};t.r(a),t.d(a,{FAILED_ADD_DASHBOARD:()=>se,FAILED_DELETE_DASHBOARD:()=>ue,FAILED_SAVE_DASHBOARD:()=>ie,FINISH_ADD_DASHBOARD:()=>ae,FINISH_DELETE_DASHBOARD:()=>ce,FINISH_SAVE_DASHBOARD:()=>ne,RECEIVE_DASHBOARD:()=>X,RECEIVE_DASHBOARD_COLLECTION_HEADERS:()=>le,RECEIVE_DASHBOARD_LAYOUT:()=>ee,RECEIVE_DASHBOARD_QUERY:()=>Z,SAVING_DASHBOARD_LAYOUT:()=>re,START_ADD_DASHBOARD:()=>te,START_DELETE_DASHBOARD:()=>oe,START_SAVE_DASHBOARD:()=>de,addDashboard:()=>G,deleteDashboard:()=>K,failedAddDashboard:()=>U,failedDeleteDashboard:()=>z,failedSaveDashboard:()=>$,finishAddDashboard:()=>N,finishDeleteDashboard:()=>j,finishSaveDashboard:()=>q,receiveDashboard:()=>x,receiveDashboardCollectionHeaders:()=>k,receiveDashboardLayout:()=>L,receiveDashboardQuery:()=>B,saveDashboard:()=>W,saveDashboardLayout:()=>J,saveDashboardLayoutFromGrid:()=>M,savingDashboardLayout:()=>F,startAddDashboard:()=>V,startDeleteDashboard:()=>Q,startSaveDashboard:()=>P});var s={};t.r(s),t.d(s,{canCreateDashboards:()=>Ee,canEditDashboard:()=>Re,getAvailableDashboards:()=>Ae,getDashboard:()=>pe,getDashboardAddableCardLDOs:()=>Ce,getDashboardForEdit:()=>_e,getDashboardLayout:()=>Te,getDashboardLayoutForGrid:()=>we,getDashboardsQueryResult:()=>ge,isAddingDashboard:()=>Be,isCanCreateDashboardsLoaded:()=>Oe,isCardAtDashboardLimit:()=>Se,isDeletingDashboard:()=>Le,isLayoutLoaded:()=>me,isRequestingDashboardLayout:()=>ve,isRequestingDashboards:()=>Ie,isSavingDashboard:()=>xe,isSavingDashboardLayout:()=>He});var d={};t.r(d),t.d(d,{canCreateDashboards:()=>Ve,getAvailableDashboards:()=>Fe,getDashboard:()=>Ne,getDashboardForEdit:()=>Ue,getDashboardLayout:()=>ke});var n={};t.r(n),t.d(n,{RECEIVE_AVAILABLE_CARDS:()=>qe,receiveAvailableCards:()=>Pe});var i={};t.r(i),t.d(i,{FAILED_ADD_DASHBOARD_CARD:()=>vr,FAILED_DASHBOARD_CARD_RPC:()=>Hr,FAILED_QUERY_DASHBOARD_CARD:()=>Ur,FAILED_REFRESH_DASHBOARD_CARD:()=>Fr,FAILED_REFRESH_DASHBOARD_CARDS:()=>Br,FINISH_ADD_DASHBOARD_CARD:()=>Ir,FINISH_DASHBOARD_CARD_RPC:()=>Or,FINISH_QUERY_DASHBOARD_CARD:()=>Nr,FINISH_REFRESH_DASHBOARD_CARD:()=>Lr,FINISH_REFRESH_DASHBOARD_CARDS:()=>wr,RECEIVE_DASHBOARD_CARD:()=>pr,RECEIVE_DASHBOARD_CARDS:()=>gr,RECEIVE_DASHBOARD_CARD_DATA:()=>Rr,RECEIVE_DASHBOARD_CARD_QUERY_ARGS:()=>_r,REMOVE_DASHBOARD_CARD:()=>Er,START_ADD_DASHBOARD_CARD:()=>Sr,START_DASHBOARD_CARD_RPC:()=>mr,START_QUERY_DASHBOARD_CARD:()=>Vr,START_REFRESH_DASHBOARD_CARD:()=>xr,START_REFRESH_DASHBOARD_CARDS:()=>Tr,START_REMOVE_DASHBOARD_CARD:()=>Cr,addAvailableCardsToDashboard:()=>cr,addDashboardCard:()=>ur,callDashboardCardRpc:()=>Ar,dashboardCardRemoved:()=>Ge,failedAddDashboardCard:()=>Je,failedDashboardCardRpc:()=>Xe,failedQueryDashboardCard:()=>or,failedRefreshDashboardCard:()=>dr,failedRefreshDashboardCards:()=>tr,finishAddDashboardCard:()=>Me,finishDashboardCardRpc:()=>Ze,finishQueryDashboardCard:()=>ir,finishRefreshDashboardCard:()=>sr,finishRefreshDashboardCards:()=>rr,queryDashboardCard:()=>fr,receiveDashboardCard:()=>Qe,receiveDashboardCardData:()=>ze,receiveDashboardCardQueryArgs:()=>je,receiveDashboardCards:()=>$e,refreshDashboardCard:()=>Dr,refreshDashboardCards:()=>yr,refreshDashboardCardsOfType:()=>br,removeDashboardCard:()=>hr,saveDashboardCard:()=>lr,startAddDashboardCard:()=>Ye,startDashboardCardRemove:()=>We,startDashboardCardRpc:()=>Ke,startQueryDashboardCard:()=>nr,startRefreshDashboardCard:()=>ar,startRefreshDashboardCards:()=>er});var o={};t.r(o),t.d(o,{getAvailableCard:()=>Pr,getAvailableCardBySelf:()=>qr,getAvailableCards:()=>kr});var c={};t.r(c),t.d(c,{getAvailableCard:()=>Qr,getAvailableCardBySelf:()=>jr,getAvailableCards:()=>$r});var u={};t.r(u),t.d(u,{areCardsLoaded:()=>rt,canEditCard:()=>Zr,getCallingDashboardCardRpcs:()=>nt,getDashboardCard:()=>Wr,getDashboardCardConfig:()=>Jr,getDashboardCardQueryArgs:()=>Mr,getDashboardCardSettings:()=>Yr,getDashboardCards:()=>Gr,getDashboardCardsByType:()=>Kr,isAddingCard:()=>at,isCallingDashboardCardRpc:()=>st,isQueryingDashboardCard:()=>it,isRefreshingDashboardCards:()=>et,isRemovingCard:()=>tt,isRequestingCards:()=>Xr});var l={};t.r(l),t.d(l,{getDashboardCardConfig:()=>ct,getDashboardCards:()=>ot});var h={};t.r(h),t.d(h,{CLOSE_EDIT_CARDS:()=>vt,NAVIGATE:()=>Rt,NAVIGATE_BACK:()=>Et,OPEN_EDIT_CARDS:()=>It,RECEIVE_STATIC_STATS:()=>mt,RECEIVE_SUGGESTED_SHARE_USERS:()=>Ct,RECEIVE_USER:()=>St,REGISTER_CARD:()=>Ht,USING_TOUCH:()=>Ot,closeEditCards:()=>Dt,openEditCards:()=>bt,receiveStaticStats:()=>gt,receiveSuggestedShareUsers:()=>ft,receiveUser:()=>At,registerCard:()=>_t,usingTouch:()=>pt,viewCreateDashboard:()=>lt,viewDashboard:()=>ut,viewHelp:()=>ht,viewPrevious:()=>yt});var y={};t.r(y),t.d(y,{getCurrentPage:()=>wt,getCurrentPageAttr:()=>Bt,getRegisteredCard:()=>kt,getStaticStats:()=>Nt,getSuggestedShareUsers:()=>Lt,getUser:()=>Ft,getViewingDashboardId:()=>xt,isEditingCards:()=>Vt,isUsingTouch:()=>Ut});var b={};t.r(b),t.d(b,{getStaticStats:()=>jt,getSuggestedShareUsers:()=>$t,getUser:()=>Qt});var D={};t.r(D),t.d(D,{RECEIVE_PRIMARY_DASHBOARD:()=>Wt,receivePrimaryDashboard:()=>zt,setPrimaryDashboard:()=>Gt});var f={};t.r(f),t.d(f,{getPrimaryDashboard:()=>Mt});var A={};t.r(A),t.d(A,{getPrimaryDashboard:()=>Jt});var g=t(58168),p=t(51609),_=t(66087),R=t(39959),E=t(31987),C=t(85631),S=t.n(C),I=t(62932);function v(e){return{type:"API_FETCH",request:e}}function m(e="info",r,t={}){return{type:"CREATE_NOTICE",status:e,content:r,options:{context:"ithemes-security",...t}}}const O={API_FETCH:({request:e})=>S()(e).catch(I.dD),SELECT:({selectorName:e,args:r})=>(0,E.select)("ithemes-security/dashboard")[e](...r),CREATE_NOTICE({status:e,content:r,options:t}){t.autoDismiss&&(t.id=t.id||(0,_.uniqueId)("itsec-auto-dismiss-"),setTimeout((()=>(0,E.dispatch)("core/notices").removeNotice(t.id,t.context)),t.autoDismiss)),(0,E.dispatch)("core/notices").createNotice(e,r,t)}};var H=t(77172),T=t(3075),w=t(31169);function B(e,r){return{type:Z,queryId:e,dashboards:r}}function x(e){return{type:X,dashboard:e}}function L(e,r){return{type:ee,dashboardId:e,layout:r}}function F(e,r){return{type:re,dashboardId:e,layout:r}}function V(e,r){return{type:te,dashboard:e,context:r}}function N(e,r,t){return{type:ae,dashboard:e,created:r,context:t}}function U(e,r,t){return{type:se,dashboard:e,context:r,error:t}}function k(e){return{type:le,headers:e}}function P(e){return{type:de,dashboardId:e}}function q(e){return{type:ne,dashboardId:e}}function $(e,r){return{type:ie,dashboardId:e,error:r}}function Q(e){return{type:oe,dashboardId:e}}function j(e){return{type:ce,dashboardId:e}}function z(e,r){return{type:ue,dashboardId:e,error:r}}function*G(e,r){let t;yield V(e,r);try{t=yield Y(e)}catch(t){return yield U(e,r,t),void(yield m("error",(0,T.sprintf)((0,T.__)("Error when creating dashboard: %s","better-wp-security"),t.message)))}return yield x(t),yield N(e,t,r),yield m("success",(0,T.__)("Dashboard Created","better-wp-security"),{autoDismiss:1e4}),t}function*W(e){let r;yield P(e.id);try{r=yield Y(e)}catch(r){return yield $(e.id,r),yield m("error",(0,T.sprintf)((0,T.__)("Error when saving dashboard: %s","better-wp-security"),r.message)),r}return yield x(r),yield q(e.id),r}function*Y(e){return yield v({path:(0,H.addQueryArgs)("/ithemes-security/v1/dashboards"+(e.id?"/"+e.id:""),{_embed:1}),method:e.id?"PUT":"POST",data:e})}function*M(e,r){const t=(0,w.cJ)(e,r);if(yield L(e,t),(0,E.select)("ithemes-security/dashboard").canEditDashboard(e))return yield J(e,t,!1)}function*J(e,r,t=!0){let a;yield F(e,r);try{a=yield v({path:`/ithemes-security/v1/dashboards/${e}/layout`,method:"PUT",data:r})}catch(e){return!1}return t&&(yield L(e,a)),a}function*K(e){yield Q(e);try{yield v({path:`/ithemes-security/v1/dashboards/${e}`,method:"DELETE"})}catch(r){return yield z(e,r),yield m("error",(0,T.sprintf)((0,T.__)("Error when deleting dashboard: %s","better-wp-security"),r.message)),r}return yield j(e),!0}const Z="RECEIVE_DASHBOARD_QUERY",X="RECEIVE_DASHBOARD",ee="RECEIVE_DASHBOARD_LAYOUT",re="SAVING_DASHBOARD_LAYOUT",te="START_ADD_DASHBOARD",ae="FINISH_ADD_DASHBOARD",se="FAILED_ADD_DASHBOARD",de="START_SAVE_DASHBOARD",ne="FINISH_SAVE_DASHBOARD",ie="FAILED_SAVE_DASHBOARD",oe="START_DELETE_DASHBOARD",ce="FINISH_DELETE_DASHBOARD",ue="FAILED_DELETE_DASHBOARD",le="RECEIVE_DASHBOARD_COLLECTION_HEADERS",he={byId:{},queries:{},layouts:{},savingLayouts:{},adding:[],saving:[],deleting:[],collectionHeaders:{}};var ye=t(84156),be=t(50030);function De(e,...r){return(0,E.select)("core/data").isResolving("ithemes-security/dashboard",e,r)}function fe(e,...r){return(0,E.select)("core/data").hasFinishedResolution("ithemes-security/dashboard",e,r)}function Ae(e){return ge(e,"available")}const ge=(0,ye.A)(((e,r)=>(0,_.filter)((0,_.map)(e.dashboard.queries[r],(r=>e.dashboard.byId[r])),_.isObject)),((e,r)=>[e.dashboard.queries[r],e.dashboard.byId]));function pe(e,r){return e.dashboard.byId[r]}function _e(e,r){return e.dashboard.byId[r]}function Re(e,r){return function(e,r){return(0,_.get)(e,["dashboard","byId",r,"_links","self",0,"targetHints","allow"],[])}(e,r).includes("PUT")}function Ee(e){return e.dashboard.collectionHeaders.allow&&e.dashboard.collectionHeaders.allow.split(", ").includes("POST")}const Ce=(0,ye.A)(((e,r)=>(0,_.filter)((0,_.get)(e,["dashboard","byId",r,"_links","create-form"],[]),(e=>(0,_.get)(e,["targetHints","allow"],[]).includes("POST"))).map((e=>({...e,aboutLink:e.targetHints.link.map(be.parse).filter((e=>!!e.about)).map((e=>e.about))[0]})))),((e,r)=>[e.dashboard.byId[r]]));function Se(e,r,t){const a=(0,E.select)("ithemes-security/dashboard").getAvailableCardBySelf(t);return!(!a||!a.max)&&(0,E.select)("ithemes-security/dashboard").getDashboardCardsByType(r,t).length>=a.max}function Ie(){return De("getAvailableDashboards")}function ve(e,r){return De("getDashboardLayout",r)}function me(e,r){return fe("getDashboardLayout",r)}function Oe(){return fe("canCreateDashboards")}function He(e,r){return e.dashboard.savingLayouts[r]}function Te(e,r){return e.dashboard.layouts[r]}const we=(0,ye.A)(((e,r)=>(0,w.ih)(r,(0,_.get)((0,E.select)("ithemes-security/dashboard").getDashboardLayout(r),"cards",[]),(0,E.select)("ithemes-security/dashboard").getDashboardCards(r)||[])),((e,r)=>[e.dashboard.layouts[r],e.availableCards,e.cards.byDashboard[r]]));function Be(e,r){return e.dashboard.adding.includes(r)}function xe(e,r){return e.dashboard.saving.includes(r)}function Le(e,r){return e.dashboard.deleting.includes(r)}function*Fe(){const e=yield v({path:(0,H.addQueryArgs)("/ithemes-security/v1/dashboards",{_embed:1})});yield B("available",e)}const Ve={*fulfill(){const e=yield v({path:"/ithemes-security/v1/dashboards",method:"HEAD",parse:!1});yield k((0,I.pC)(e.headers))},isFulfilled:e=>!!e.dashboard.collectionHeaders.allow};function*Ne(){yield E.controls.resolveSelect("ithemes-security/dashboard","getAvailableDashboards")}function*Ue(e){const r=yield v({path:(0,H.addQueryArgs)(`/ithemes-security/v1/dashboards/${e}`,{_embed:1,context:"edit"})});yield x(r)}function*ke(e){const r=yield v({path:`/ithemes-security/v1/dashboards/${e}/layout`});yield L(e,r)}function Pe(e){return{type:qe,cards:e}}const qe="RECEIVE_AVAILABLE_CARDS";function $e(e,r){return{type:gr,dashboardId:e,cards:r}}function Qe(e,r){return{type:pr,dashboardId:e,card:r}}function je(e,r){return{type:_r,cardId:e,queryArgs:r}}function ze(e,r,t){return{type:Rr,cardId:e,data:r,links:t}}function Ge(e,r){return{type:Er,dashboardId:e,cardId:r}}function We(e,r){return{type:Cr,dashboardId:e,cardId:r}}function Ye(e,r,t){return{type:Sr,collectionEP:e,card:r,context:t}}function Me(e,r,t){return{type:Ir,collectionEP:e,card:r,context:t}}function Je(e,r,t,a){return{type:vr,collectionEP:e,card:r,context:t,error:a}}function Ke(e,r,t){return{type:mr,cardId:e,href:r,data:t}}function Ze(e,r,t,a){return{type:Or,cardId:e,href:r,data:t,response:a}}function Xe(e,r,t,a){return{type:Hr,cardId:e,href:r,data:t,error:a}}function er(e){return{type:Tr,dashboardId:e}}function rr(e){return{type:wr,dashboardId:e}}function tr(e,r){return{type:Br,dashboardId:e,error:r}}function ar(e){return{type:xr,cardId:e}}function sr(e){return{type:Lr,cardId:e}}function dr(e,r){return{type:Fr,cardId:e,error:r}}function nr(e){return{type:Vr,cardId:e}}function ir(e){return{type:Nr,cardId:e}}function or(e,r){return{type:Ur,cardId:e,error:r}}function*cr(e){const r=yield E.controls.select("ithemes-security/dashboard","getDashboardAddableCardLDOs",e);for(const e of r)yield*ur(e.href,{})}function*ur(e,r,t){let a;yield Ye(e,r,t);try{a=yield v({url:(0,H.addQueryArgs)(e,{_embed:1}),method:"POST",data:r})}catch(a){return yield Je(e,r,t,a),void(yield m("error",(0,T.sprintf)((0,T.__)("Error when adding card to dashboard: %s","better-wp-security"),a.message)))}yield Me(e,r,t),yield Qe(a.dashboard,a)}function*lr(e,r){const t=r.id;let a;try{a=yield v({path:`/ithemes-security/v1/dashboards/${e}/cards/${r.card}${t?"/"+t:""}`,method:t?"PUT":"POST",data:r})}catch(e){return yield m("error",(0,T.sprintf)((0,T.__)("Error when saving dashboard card: %s","better-wp-security"),e.message)),e}return yield Qe(e,a),a}function*hr(e,r,t=!0){yield We(e,r.id),t&&(yield Ge(e,r.id));try{yield v({path:`/ithemes-security/v1/dashboards/${e}/cards/${r.card}/${r.id}`,method:"DELETE",parse:!1})}catch(a){return t&&(yield Qe(e,r)),void(yield m("error",(0,T.sprintf)((0,T.__)("Error when removing card from dashboard: %s","better-wp-security"),a.message)))}t||(yield Ge(e,r.id))}function*yr(e){yield er(e);const r=(0,E.select)("ithemes-security/dashboard"),t=r.getDashboardCards(e),a={_fields:["id","data","_links"],cards:{}};for(const e of t)(0,_.set)(a,["cards",e.card,e.id],r.getDashboardCardQueryArgs(e.id));let s;try{s=yield v({path:(0,H.addQueryArgs)(`/ithemes-security/v1/dashboards/${e}/cards`,a)})}catch(r){return yield tr(e,r),yield m("warning",(0,T.sprintf)((0,T.__)("Refreshing dashboard data failed: %s","better-wp-security"),r.message),{autoDismiss:!0}),r}const d={};for(const e of s)d[e.id]=e.data,yield ze(e.id,e.data,e._links);return yield rr(e),d}function*br(e,r){r=(0,_.castArray)(r);const t=(0,E.select)("ithemes-security/dashboard").getDashboardCards(e);for(const e of t)r.includes(e.card)&&(0,E.dispatch)("ithemes-security/dashboard").refreshDashboardCard(e.id)}function*Dr(e){const r=(0,E.select)("ithemes-security/dashboard").getDashboardCard(e);if(!r)throw new Error("No card loaded with that id.");yield ar(e);const t=yield v({path:(0,H.addQueryArgs)(`/ithemes-security/v1/dashboards/${r.dashboard}/cards/${r.card}/${e}`,{...(0,E.select)("ithemes-security/dashboard").getDashboardCardQueryArgs(e),_fields:["data","_links"]})});return yield ze(e,t.data,t._links),yield sr(e),t.data}function*fr(e,r){const t=(0,E.select)("ithemes-security/dashboard").getDashboardCard(e);if(!t)throw new Error("No card loaded with that id.");yield nr(e);const a=yield v({path:(0,H.addQueryArgs)(`/ithemes-security/v1/dashboards/${t.dashboard}/cards/${t.card}/${e}`,{...r,_fields:["data","_links"]})});return yield ze(e,a.data,a._links),yield je(e,r),yield ir(e),a.data}function*Ar(e,r,t){let a;yield Ke(e,r,t);try{a=yield v({url:r,method:"POST",data:t})}catch(a){return yield Xe(e,r,t,a),yield m("error",(0,T.sprintf)((0,T.__)("Error when performing card action: %s","better-wp-security"),a.message)),a}return yield Ze(e,r,t,a),yield Dr(e),a}const gr="RECEIVE_DASHBOARD_CARDS",pr="RECEIVE_DASHBOARD_CARD",_r="RECEIVE_DASHBOARD_CARD_QUERY_ARGS",Rr="RECEIVE_DASHBOARD_CARD_DATA",Er="REMOVE_DASHBOARD_CARD",Cr="START_REMOVE_DASHBOARD_CARD",Sr="START_ADD_DASHBOARD_CARD",Ir="FINISH_ADD_DASHBOARD_CARD",vr="FAILED_ADD_DASHBOARD_CARD",mr="START_DASHBOARD_CARD_RPC",Or="FINISH_DASHBOARD_CARD_RPC",Hr="FAILED_DASHBOARD_CARD_RPC",Tr="START_REFRESH_DASHBOARD_CARDS",wr="FINISH_REFRESH_DASHBOARD_CARDS",Br="FAILED_REFRESH_DASHBOARD_CARDS",xr="START_REFRESH_DASHBOARD_CARD",Lr="FINISH_REFRESH_DASHBOARD_CARD",Fr="FAILED_REFRESH_DASHBOARD_CARD",Vr="START_QUERY_DASHBOARD_CARD",Nr="FINISH_QUERY_DASHBOARD_CARD",Ur="FAILED_QUERY_DASHBOARD_CARD",kr=(0,ye.A)((e=>Object.values(e.availableCards)),(e=>[e.availableCards]));function Pr(e,r){return e.availableCards[r]}const qr=(0,ye.A)(((e,r)=>(0,_.find)(e.availableCards,(e=>(0,_.get)(e,["_links","self",0,"href"])===r))),(e=>[e.availableCards]));function*$r(){try{const e=yield v({path:"/ithemes-security/v1/dashboard-available-cards"});yield Pe(e)}catch(e){yield Pe([])}}function*Qr(){yield(0,E.select)("ithemes-security/dashboard").getAvailableCards()}function*jr(){yield(0,E.select)("ithemes-security/dashboard").getAvailableCards()}const zr={byId:{},byDashboard:{},queryArgs:{},deleting:[],adding:[],rpcs:{},refreshingDashboards:[],querying:[]},Gr=(0,ye.A)(((e,r)=>(0,_.map)(e.cards.byDashboard[r],(r=>e.cards.byId[r]))),((e,r)=>[e.cards.byDashboard[r],e.cards.byId]));function Wr(e,r){return e.cards.byId[r]}function Yr(e,r){return(0,_.get)(e,["cards","byId",r,"settings"])}function Mr(e,r){return e.cards.queryArgs[r]}function Jr(e,r){const t=(0,E.select)("ithemes-security/dashboard").getDashboardCard(r);if(t)return(0,E.select)("ithemes-security/dashboard").getAvailableCard(t.card)}function Kr(e,r,t){const a=(0,E.select)("ithemes-security/dashboard").getDashboardCards(r),s=[];for(const e of a)(0,_.get)(e,["_links","about",0,"href"])===t&&s.push(e);return s}function Zr(e,r,t){return!(!(0,E.select)("ithemes-security/dashboard").canEditDashboard(r)||!t)}function Xr(e,r){return De("getDashboardCards",r)}function et(e,r){return e.cards.refreshingDashboards.includes(r)}function rt(e,r){return fe("getDashboardCards",r)}function tt(e,r){return e.cards.deleting.includes(r)}function at(e,r){return e.cards.adding.includes(r)}function st(e,r,t){return e.cards.rpcs[r]&&e.cards.rpcs[r].includes(t)}const dt=[];function nt(e,r){return e.cards.rpcs[r]||dt}function it(e,r){return e.cards.querying.includes(r)}function*ot(e){const r=yield v({path:`/ithemes-security/v1/dashboards/${e}/cards?_embed=1`});yield $e(e,r)}function*ct(e){const r=(0,E.select)("ithemes-security/dashboard").getDashboardCard(e);r&&!(0,E.select)("ithemes-security/dashboard").getAvailableCard(r.card)&&(0,E.select)("ithemes-security/dashboard").getAvailableCards()}function ut(e){return{type:Rt,page:"view-dashboard",attr:{id:e}}}function lt(){return{type:Rt,page:"create-dashboard"}}function ht(){return{type:Rt,page:"help"}}function yt(){return{type:Et}}function bt(){return{type:It}}function Dt(){return{type:vt}}function ft(e){return{type:Ct,users:e}}function At(e){return{type:St,user:e}}function gt(e,r){return{type:mt,stats:e,query:r}}function pt(e=!0){return{type:Ot,isUsing:e}}function _t(e,r){return{type:Ht,slug:e,settings:r}}const Rt="NAVIGATE",Et="NAVIGATE_BACK",Ct="RECEIVE_SUGGESTED_SHARE_USERS",St="RECEIVE_USER",It="OPEN_EDIT_CARDS",vt="CLOSE_EDIT_CARDS",mt="RECEIVE_STATIC_STATS",Ot="USING_TOUCH",Ht="REGISTER_CARD",Tt={view:{page:"",attr:{}},previousView:null,editingCards:!1,suggestedShareUsers:[],users:{byId:{}},staticStats:{data:{},query:{}},usingTouch:!1,cards:{}};function wt(e){return e.app.view.page}function Bt(e){return e.app.view.attr}function xt(e){return"create-dashboard"===e.app.view.page?e.app.previousView?.attr.id:"view-dashboard"===e.app.view.page?e.app.view.attr.id:void 0}function Lt(e){return e.app.suggestedShareUsers}function Ft(e,r){return e.app.users.byId[r]}function Vt(e){return e.app.editingCards}function Nt(e){return e.app.staticStats.data}function Ut(e){return e.app.usingTouch}function kt(e,r){return e.app.cards[r]}var Pt=t(62247),qt=t.n(Pt);function*$t(){const e=yield v({path:(0,H.addQueryArgs)("/wp/v2/users",{roles:"administrator"})});yield ft(e)}function*Qt(e){const r=yield v({path:`/wp/v2/users/${e}`});yield At(r)}const jt={*fulfill(e){const r="/ithemes-security/v1/dashboard-static",t=yield v({path:(0,_.isEmpty)(e)?r:(0,H.addQueryArgs)(r,e)});yield gt(t,e)},isFulfilled:(e,r)=>qt()(e.app.staticStats.query,r)};function zt(e){return{type:Wt,dashboardId:e}}function*Gt(e){yield E.controls.dispatch("ithemes-security/core","saveCurrentUser",{meta:{_itsec_primary_dashboard:e}},!0),yield zt(e)}const Wt="RECEIVE_PRIMARY_DASHBOARD",Yt={primaryDashboard:void 0};function Mt(e){return e.user.primaryDashboard}function*Jt(){const e=yield E.controls.resolveSelect("ithemes-security/core","getCurrentUser");yield zt(e.meta._itsec_primary_dashboard)}const Kt={reducer:(0,E.combineReducers)({dashboard:function(e=he,r){switch(r.type){case Z:return{...e,byId:{...e.byId,...(0,_.keyBy)(r.dashboards,"id")},queries:{...e.queries,[r.queryId]:(0,_.map)(r.dashboards,(e=>e.id))}};case X:return{...e,byId:{...e.byId,[r.dashboard.id]:r.dashboard},queries:{...e.queries,available:e.queries.available.includes(r.dashboard.id)?e.queries.available:[...e.queries.available,r.dashboard.id]}};case ee:return{...e,layouts:{...e.layouts,[r.dashboardId]:r.layout},savingLayouts:{...e.savingLayouts,[r.dashboardId]:!1}};case re:return{...e,savingLayouts:{...e.savingLayouts,[r.dashboardId]:!0}};case te:return r.context?{...e,adding:[...e.adding,r.context]}:e;case ae:case se:return{...e,adding:e.adding.filter((e=>e!==r.context))};case de:return{...e,saving:[...e.saving,r.dashboardId]};case ne:case ie:return{...e,saving:e.saving.filter((e=>e!==r.dashboardId))};case le:return{...e,collectionHeaders:r.headers};case oe:return{...e,deleting:[...e.deleting,r.dashboardId]};case ce:return{...e,deleting:e.deleting.filter((e=>e!==r.dashboardId)),byId:(0,_.omit)(e.byId,[r.dashboardId])};case ue:return{...e,deleting:e.deleting.filter((e=>e!==r.dashboardId))};default:return e}},availableCards:function(e={},r){switch(r.type){case qe:return{...e,...(0,_.keyBy)(r.cards,"slug")};case gr:const t={};for(const a of r.cards)if((0,_.has)(a,["_embedded","about",0])){const r=a._embedded.about[0].slug;e[r]||(t[r]=a._embedded.about[0])}return(0,_.isEmpty)(t)?e:{...e,...t};default:return e}},cards:function(e=zr,r){switch(r.type){case gr:return{...e,byId:{...e.byId,...(0,_.keyBy)(r.cards,"id")},byDashboard:{...e.byDashboard,[r.dashboardId]:(0,_.map)(r.cards,(e=>e.id))}};case pr:return{...e,byId:{...e.byId,[r.card.id]:r.card},byDashboard:{...e.byDashboard,[r.dashboardId]:e.byDashboard[r.dashboardId]&&e.byDashboard[r.dashboardId].includes(r.card.id)?e.byDashboard[r.dashboardId]:[...(0,_.get)(e,["byDashboard",r.dashboardId],[]),r.card.id]}};case _r:return{...e,queryArgs:{...e.queryArgs,[r.cardId]:r.queryArgs}};case Rr:return{...e,byId:{...e.byId,[r.cardId]:{...e.byId[r.cardId],data:r.data,_links:r.links}}};case Cr:return{...e,deleting:[...e.deleting,r.cardId]};case Er:return{...e,byId:(0,_.omit)(e.byId,r.cardId),byDashboard:{...e.byDashboard,[r.dashboardId]:(0,_.filter)(e.byDashboard[r.dashboardId],(e=>e!==r.cardId))},deleting:(0,_.filter)(e.deleting,(e=>e!==r.cardId))};case Sr:return r.context?{...e,adding:[...e.adding,r.context]}:e;case Ir:case vr:return{...e,adding:e.adding.filter((e=>e!==r.context))};case mr:return{...e,rpcs:{...e.rpcs,[r.cardId]:[...e.rpcs[r.cardId]||[],r.href]}};case Or:case Hr:return{...e,rpcs:{...e.rpcs,[r.cardId]:(e.rpcs[r.cardId]||[]).filter((e=>e!==r.href))}};case Tr:return{...e,refreshingDashboards:[...e.refreshingDashboards,r.dashboardId]};case wr:case Br:return{...e,refreshingDashboards:e.refreshingDashboards.filter((e=>e!==r.dashboardId))};case Vr:return{...e,querying:[...e.querying,r.cardId]};case Nr:return{...e,querying:e.querying.filter((e=>e!==r.cardId))};default:return e}},app:function(e=Tt,r){switch(r.type){case Rt:return{...e,view:{page:r.page,attr:r.attr||{}},previousView:e.view};case Et:return{...e,view:e.previousView||Tt.view,previousView:null};case Ct:return{...e,suggestedShareUsers:r.users,users:{...e.users,byId:{...e.users.byId,...(0,_.keyBy)(r.users,"id")}}};case St:return{...e,users:{...e.users,byId:{...e.users.byId,[r.user.id]:r.user}}};case ae:return["create-dashboard-scratch","create-dashboard-default"].includes(r.context)?{...e,editingCards:!0,view:{page:"view-dashboard",attr:{id:r.created.id}}}:e;case It:return{...e,editingCards:!0};case vt:return{...e,editingCards:!1};case mt:return{...e,staticStats:{data:r.stats,query:r.query}};case Ot:return{...e,usingTouch:r.isUsing};case Ht:return{...e,cards:{...e.cards,[r.slug]:r.settings}};default:return e}},user:function(e=Yt,r){return r.type===Wt?{...e,primaryDashboard:r.dashboardId}:e}}),controls:{...O},actions:{...a,...n,...i,...h,...D},selectors:{...s,...o,...u,...y,...f},resolvers:{...d,...c,...l,...b,...A}};function Zt({type:e="secondary",...r}){return(0,p.createElement)(R.Fill,(0,g.A)({name:`AdminBar${(0,_.capitalize)(e)}`},r))}function Xt({type:e="secondary",...r}){return(0,p.createElement)(R.Slot,(0,g.A)({name:`AdminBar${(0,_.capitalize)(e)}`},r))}function ea(e){return(0,p.createElement)(R.Fill,(0,g.A)({name:"BelowToolbar"},e))}function ra(e){return(0,p.createElement)(R.Slot,(0,g.A)({name:"BelowToolbar"},e))}function ta(e){return(0,p.createElement)(R.Fill,(0,g.A)({name:"EditCards"},e))}function aa(e){return(0,p.createElement)(R.Slot,(0,g.A)({name:"EditCards"},e))}(0,E.registerStore)("ithemes-security/dashboard",Kt),t.p=window.itsecWebpackPublicPath},74848:(e,r,t)=>{"use strict";e.exports=t(21020)},77172:e=>{e.exports=function(){return this.wp.url}()},82284:(e,r,t)=>{"use strict";function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}t.d(r,{A:()=>a})},84156:(e,r,t)=>{"use strict";var a,s;function d(e){return[e]}function n(){var e={clear:function(){e.head=null}};return e}function i(e,r,t){var a;if(e.length!==r.length)return!1;for(a=t;a<e.length;a++)if(e[a]!==r[a])return!1;return!0}function o(e,r){var t,o;function c(){t=s?new WeakMap:n()}function u(){var t,a,s,d,n,c=arguments.length;for(d=new Array(c),s=0;s<c;s++)d[s]=arguments[s];for(n=r.apply(null,d),(t=o(n)).isUniqueByDependants||(t.lastDependants&&!i(n,t.lastDependants,0)&&t.clear(),t.lastDependants=n),a=t.head;a;){if(i(a.args,d,1))return a!==t.head&&(a.prev.next=a.next,a.next&&(a.next.prev=a.prev),a.next=t.head,a.prev=null,t.head.prev=a,t.head=a),a.val;a=a.next}return a={val:e.apply(null,d)},d[0]=null,a.args=d,t.head&&(t.head.prev=a,a.next=t.head),t.head=a,a.val}return r||(r=d),o=s?function(e){var r,s,d,i,o,c=t,u=!0;for(r=0;r<e.length;r++){if(!(o=s=e[r])||"object"!=typeof o){u=!1;break}c.has(s)?c=c.get(s):(d=new WeakMap,c.set(s,d),c=d)}return c.has(a)||((i=n()).isUniqueByDependants=u,c.set(a,i)),c.get(a)}:function(){return t},u.getDependants=r,u.clear=c,c(),u}t.d(r,{A:()=>o}),a={},s="undefined"!=typeof WeakMap},85631:e=>{e.exports=function(){return this.wp.apiFetch}()},98616:e=>{e.exports=function(e,r){var t,a,s=0;function d(){var d,n,i=t,o=arguments.length;e:for(;i;){if(i.args.length===arguments.length){for(n=0;n<o;n++)if(i.args[n]!==arguments[n]){i=i.next;continue e}return i!==t&&(i===a&&(a=i.prev),i.prev.next=i.next,i.next&&(i.next.prev=i.prev),i.next=t,i.prev=null,t.prev=i,t=i),i.val}i=i.next}for(d=new Array(o),n=0;n<o;n++)d[n]=arguments[n];return i={args:d,val:e.apply(null,d)},t?(t.prev=i,i.next=t):a=i,s===r.maxSize?(a=a.prev).next=null:s++,t=i,i.val}return r=r||{},d.clear=function(){t=null,a=null,s=0},d}}},e=>{e.O(0,[2038,2932],(()=>e(e.s=66885)));var r=e.O();((window.itsec=window.itsec||{}).dashboard=window.itsec.dashboard||{}).api=r}]);